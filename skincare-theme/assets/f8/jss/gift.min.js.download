(()=>{(function(){let{proxy:st,integration:nt,utils:at,customize:ct,shopifyFunc:J,storefront:W}=window.FGSECOMAPP?.helper||{};FGSECOMAPP.variables={...FGSECOMAPP.variables,conditions:{collections:!1,locations:!1,function:!1,shipping:!1},isCheckout:!1,isCartPage:window.location.href.includes("/cart"),paymentsConfig:null,failedParseArrOffersAdded:!1,secomappGetCartRunning:!1,fgCallback:[],scaCountRenderEventCheckout:0,checkIsBlockCheckout:!1,hasDoneProcessCheckout:!1,giftIds:[],gifts:{originalProducts:[],clonedProducts:[],offers_shipping:[]},giftIdsFunction:[],maxOfferPriority:null,maxTodayOfferPriority:null,sections_cart:{},bogos_other_discounts:[],bogos_shipping_discounts:[]},FGSECOMAPP.CUSTOM_EVENTS={...FGSECOMAPP.CUSTOM_EVENTS,RERENDER_GIFT_SLIDER:"bogos:glider",SHOW_GIFT_SLIDER:"fg-gifts:show-slider",PRODUCT_HAS_GIFTS:"fg-gifts:gift-icon",GIFT_UPDATED:"fg-gifts:updated",GIFT_ADDED:"fg-gifts:added",CART_AUTO_UPDATED:"fg-cart:auto-updated",START_PROCESS_CART:"fg-cart:start-process",END_PROCESS_CART:"fg-cart:end-process",START_VALIDATE_CHECKOUT:"fg-checkout:start",END_VALIDATE_CHECKOUT:"fg-checkout:end",START_RENDER_APP:"fg-app:start",END_RENDER_APP:"fg-app:end",FG_OVERRIDE_FETCH:"fg-fetch:override",FG_OVERRIDE_XHR_OPEN:"fg-xhr:open",FG_OVERRIDE_XHR_SEND:"fg-xhr:send",RENDER_TODAY_OFFER:"fg-today-offer:render",TODAY_OFFER_CHANGE:"fg-today-offer:success",RENDER_CART_MESSAGE:"fg-messages:render",BOGOS_FG_PROCESS:"bogos:gifts",BOGOS_FG_INIT:"bogos:gifts-init",BOGOS_FG_CART_MESSAGE:"bogos:message",BOGOS_FG_START:"bogos:gifts-start",BOGOS_FG_END:"bogos:gifts-end",BOGOS_GIFT_OFFER_CHECK:"bogos:gift-check"},FGSECOMAPP.helper.scaCustomLoadingCheckout=Shopify?.scaCustomLoadingCheckout??void 0;let L=FGSECOMAPP.variables.RATE_PRICE??100,B={cart:new RegExp(/(\/cart\/(add|change|update|clear)(\.js)?)/g),render_cart:new RegExp(/(\/cart\/(add|change|update|clear)(\.js)?(.*)(sca_reload_cart))/g),proxy:new RegExp(`/(${SECOMAPP.freegiftProxy})/g`),graphql:new RegExp(/(cartLinesRemove|cartLinesUpdate|cartLinesAdd)/g)},A={OFFER_TYPE:{cloned:"cloned",function:"function",gift_func:"gift"},APP_REVIEW_OPTION:{bundle:"bundle",gift_slider:"gift_slider"},APP_REVIEW:{judgeme:"judgeme",trustoo:"trustoo"},CUSTOM_OPTIONS:{equal:"equal_to",not_equal:"not_equal_to",contains:"contains",not_contains:"not_contains"},NARROW_TYPE:{product:"variants_ids",product_types:"product_types",product_vendors:"product_vendors",collection:"product_collections"},DISCOUNT_TYPE:{percentage:"percentage",fixed_amount:"fixed_amount",fixed_price:"fixed_price",free_products:"free_products",cheapest_free:"cheapest_free",shipping:"shipping_discount"},SYNC_QUANTITY:{stop_offer:"stop_offer"},OBJECT_TYPE:{product:"product",variant:"variant"}};A.TRIGGER_FUNC={[A.OFFER_TYPE.gift_func]:"GF"};let O={GIFTS_CART_SECTION_ID:"#sca_fg_cart_section_gifts_slider",GIFTS_CART_SECTION:`<div class="slide-container">
                <div class="fg-section-title">
                    {{ fg_slider_title }}
                </div>
                <div class="glider-contain">
                    <div class="glider bogos-gift-items" id="fg-gift-items"></div>
                    <div>
                        <button type="button" aria-label="Previous" class="glider-prev nav left-nav btn-nav-slide">\u276E</button>
                    </div>
                    <div>
                        <button type="button" aria-label="Next" class="glider-next nav right-nav btn-nav-slide">\u276F</button>
                    </div>
                </div>
                <div role="tablist" class="dots"></div>

                {{ sca_fg_disable_slider_section }}
            </div>`,GIFTS_CART_SECTION_V2_ID:"#bogos_cart_section_gifts_slider",GIFTS_CART_SECTION_V2:`<div class="bogos-gifts-slider-container">
                <div class="bogos-gifts-slider-header">
                    <div class="bogos-slider-header-info">
                        <div class="bogos-slider-info-title">
                            {{fg_slider_title}}
                        </div>
                        <div class="bogos-slider-info-subtitle {{ bogos_check_show_offer_available }}">
                            {{bogos_slider_offer_available}}
                        </div>
                    </div>
                </div>
                <div class="bogos-slider-offers-container">
                </div>
                {{bogos_brand_mark}}
            </div>`,GIFTS_POPUP_SECTION_ID:"#sca_fg_section_gifts_popup",GIFTS_POPUP_SECTION:`<div class="slide-container sca-modal-dialog-fg">
                <button class="sca-close-modal-fg btn" type="button" aria-label="close modal" data-close>\u2715</button>
                <div class="fg-section-title">
                    {{ fg_slider_title }}
                </div>
                <div class="glider-contain">
                    <div class="glider bogos-gift-items" id="fg-gift-items"></div>
                    <div>
                        <button type="button" aria-label="Previous" class="glider-prev nav left-nav btn-nav-slide">\u276E</button>
                    </div>
                    <div>
                        <button type="button" aria-label="Next" class="glider-next nav right-nav btn-nav-slide">\u276F</button>
                    </div>
                </div>
                <div role="tablist" class="dots"></div>

                {{ sca_fg_disable_slider_section }}
            </div>`,GIFTS_POPUP_SECTION_V2_ID:"#bogos_section_gifts_popup",GIFTS_POPUP_SECTION_V2:`<div class="bogos-gifts-slider-container bogos-gift-slider-modal">
                <div class="bogos-gifts-slider-header">
                    <div class="bogos-slider-header-info">
                        <div class="bogos-slider-info-title">
                            {{fg_slider_title}}
                        </div>
                        <div class="bogos-slider-info-subtitle {{ bogos_check_show_offer_available }}">
                            {{bogos_slider_offer_available}}
                        </div>
                    </div>
                    <button type="button" class="bogos-slider-close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="11" viewBox="0 0 12 11" fill="none">
                           <path d="M9.96967 10.2803C10.2626 10.5732 10.7374 10.5732 11.0303 10.2803C11.3232 9.98744 11.3232 9.51256 11.0303 9.21967L7.06066 5.25L11.0303 1.28033C11.3232 0.987437 11.3232 0.512564 11.0303 0.21967C10.7374 -0.0732229 10.2626 -0.0732229 9.96967 0.21967L6 4.18934L2.03033 0.21967C1.73744 -0.0732233 1.26256 -0.0732233 0.96967 0.21967C0.676777 0.512563 0.676777 0.987437 0.96967 1.28033L4.93934 5.25L0.96967 9.21967C0.676777 9.51256 0.676777 9.98744 0.96967 10.2803C1.26256 10.5732 1.73744 10.5732 2.03033 10.2803L6 6.31066L9.96967 10.2803Z" fill="#8A8A8A"/>
                        </svg>
                    </button>
                </div>
                <div class="bogos-slider-offers-container">
                </div>
                {{bogos_brand_mark}}
            </div>`,GIFT_OFFER_SECTION_ID:"#bogos_section_slider_offer",GIFT_OFFER_SECTION:`<div class="bogos-slider-offer" data-offer="{{ bogos_offer_id }}">
                <div class="bogos-slider-offer-title {{ bogos_check_offer_title }}">
                    {{ bogos_offer_title }}
                </div>
                <div class="bogos-slider-offer-badge-container {{ check_show_number_gift_available }}">
                    <div class="bogos-slider-offer-badge {{ check_show_number_gift_available_type }}">

                          <span class="bogos-badge-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="14" viewBox="0 0 12 14" fill="none">
                              <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M4.5 0C3.4801 0 2.6385 0.763422 2.51547 1.75H2.25C1.00736 1.75 0 2.75736 0 4V11.75C0 12.9926 1.00736 14 2.25 14H9.75C10.9926 14 12 12.9926 12 11.75V4C12 2.75736 10.9926 1.75 9.75 1.75H9.48453C9.3615 0.763422 8.5199 0 7.5 0H4.5ZM7.5 1.5H4.5C4.22386 1.5 4 1.72386 4 2V3C4 3.27614 4.22386 3.5 4.5 3.5H7.5C7.77614 3.5 8 3.27614 8 3V2C8 1.72386 7.77614 1.5 7.5 1.5ZM9.28033 7.28033C9.57322 6.98744 9.57322 6.51256 9.28033 6.21967C8.98744 5.92678 8.51256 5.92678 8.21967 6.21967L5.25 9.18934L4.03033 7.96967C3.73744 7.67678 3.26256 7.67678 2.96967 7.96967C2.67678 8.26256 2.67678 8.73744 2.96967 9.03033L4.71967 10.7803C5.01256 11.0732 5.48744 11.0732 5.78033 10.7803L9.28033 7.28033Z"
                                    fill="#29845A"/>
                            </svg>
                          </span>
                        <span class="bogos-badge-title">
                            {{ bogos_number_gift_available }}
                          </span>
                    </div>
                </div>
                <div class="glider-contain">
                    <div class="glider bogos-offer-gift-items-container" id="fg-gift-items"></div>
                    <div>
                        <button type="button" aria-label="Previous" class="glider-prev nav left-nav btn-nav-slide">\u276E</button>
                    </div>
                    <div>
                        <button type="button" aria-label="Next" class="glider-next nav right-nav btn-nav-slide">\u276F</button>
                    </div>
                </div>
                <div role="tablist" class="dots"></div>
                {{ sca_fg_disable_slider_section }}
            </div>`,GIFT_ITEM_SECTION_ID:"#sca_fg_section_gift_item",GIFT_ITEM_SECTION:`<div class="d-flex product-item">
                <div class="product-content">
                    <div class="top-content">
                        <a class="gift-original-url" href="{{ fg_product_handle }}" target="_blank">
                            <img loading="lazy" class="product-item-thumbnail" src="{{ fg_product_img }}" alt="{{ fg_product_img_alt }}">
                            <p class="product-title">{{ fg_product_title }}</p>
                            <p class="product-title variant-title {{ fg_gifts_check_show_by_variants }}">
                                <span class="selected-variant {{ fg_check_selected_variant }}">
                                    {{ fg_variant_title }}
                                </span>
                            </p>
                        </a>
                    </div>
                    {{ bogos_integration_judgeme }}
                    {{ bogos_integration_trustoo }}
                    <div class="d-flex bottom-content">
                        <div class="d-flex price-section">
                            <span class="original-price transcy-money">
                                <del>{{ fg_original_price }}</del>
                            </span>
                            <span class="gift-price transcy-money">{{ fg_gift_price }}</span>
                        </div>

                        <div class="dropdown {{ fg_gifts_check_show_by_products }}">
                            <div class="select">
                                <span class="selected-variant {{ fg_check_selected_variant }}">
                                    {{ fg_variant_title }}
                                </span>
                                <i class="fa fa-chevron-left"></i>
                            </div>
                            <ul class="dropdown-menu">
                                {{ sca_fg_variant_select_section }}
                            </ul>
                        </div>

                        <button type="button" class="btn-add-to-cart" data-offer="{{ fg_product_belongs_to_offer }}" data-variant="{{ fg_variant_id }}">
                            {{ fg_add_to_cart }}
                        </button>
                    </div>
                </div>
            </div>`,GIFT_ITEM_SECTION_V2_ID:"#bogos_section_gift_item",GIFT_ITEM_SECTION_V2:` <div class="bogos-offer-gift-item">
                <div class="bogos-gift-item-top-info">
                    <div class="bogos-gift-item-image-container">
                        <a class="gift-original-url" href="{{ fg_product_handle }}" target="_blank">
                            <img loading="lazy" class="bogos-gift-item-image" src="{{ fg_product_img }}" alt="{{ fg_product_img_alt }}">
                        </a>
                    </div>
                    <a class="gift-original-url" href="{{ fg_product_handle }}" target="_blank">
                        <div class="bogos-gift-item-title">
                            <div class="bogos-gift-product-title">
                                {{ fg_product_title }}
                            </div>
                        </div>
                    </a>
                </div>
                <div class="bogos-gift-item-bottom-info">
                    <div class="bogos-gift-select-variant-wrapper {{bogos_check_show_select_variant}}">
                          <div class="bogos-gift-select-variant-dropdown">
                          <div class="bogos-gift-select-variant-title-contain">
                            <span class="bogos-gift-select-variant-title">{{ bogos_default_select_variant_title }}</span>
                          </div>
                            <div class="bogos-gift-select-variant-options">
                               {{ sca_fg_variant_select_section }}
                            </div>
                          </div>
                    </div>

                    <span class="bogos-gift-variant-title {{ fg_gifts_check_show_by_variants }}">
                      {{ fg_variant_title }}
                    </span>
                    {{ bogos_integration_judgeme }}
                    {{ bogos_integration_trustoo }}

                    <div class="bogos-gift-item-price-container">
                          <span class="bogos-gift-item-price">
                            {{ fg_gift_price }}
                          </span>
                        <span class="bogos-gift-item-compare-price">
                            {{ fg_original_price }}
                          </span>
                    </div>
                    <div class="bogos-gift-item-add-container">
                    <div class="bogos-gift-item-quantity-wrapper {{bogos_check_show_quantity_box}}">
                      <div class="bogos-gift-item-quantity-dropdown">
                        <input class="bogos-gift-item-quantity-input" type="text" value="1" min="1" max="{{ bogos_number_max_gifts }}" readonly />
                        <ul class="bogos-gift-item-quantity-options">
                          {{ bogos_gift_quantity_options }}
                        </ul>
                      </div>
                    </div>
                    <button type="button" class="bogos-gift-item-add-btn btn-add-to-cart" data-offer="{{ fg_product_belongs_to_offer }}" data-variant="{{ fg_variant_id }}" data-product="{{ fg_product_id }}">
                          {{ fg_add_to_cart }}
                     </button>
                    </div>
                </div>
            </div>`,GIFT_SELECT_SECTION_ID:"#sca_fg_variant_select_section",GIFT_SELECT_SECTION:`<li class="bogos-gift-select-variant-option" data-img="{{ fg_variant_img }}" id="{{ fg_variant_id }}" data-original-id="{{ fg_original_variant_id }}" data-price="{{ fg_variant_price }}" data-original-price="{{ fg_original_variant_price }}">
                {{ fg_variant_title }}
            </li>`,GIFT_SELECT_SECTION_V2_ID:"#bogos_variant_select_section",GIFT_SELECT_SECTION_V2:`<div class="bogos-gift-select-variant-option" data-img="{{ fg_variant_img }}" data-variant-id="{{ fg_variant_id }}" data-original-id="{{ fg_original_variant_id }}" data-price="{{ fg_variant_price }}" data-original-price="{{ fg_original_variant_price }}">
                {{ fg_variant_title }}
            </div>`,DISABLE_SLIDER_SECTION_ID:"#sca_fg_disable_slider_section",DISABLE_SLIDER_SECTION:`<div id="sca-hidden-gift-popup" class="bogos-slider-offer-switch-show">
                 <label class="switch">
                    <input type="checkbox" id="sca-disable-checkbox" class="sca-disable-checkbox" name="sca-disable-checkbox">
                    <span class="slider"></span>
                 </label>
                 <span class="bogos-offer-switch-title">
                    {{ fg_text_disable_slider }}
                 </span>
            </div>`,CART_MSG_SECTION_ID:"#sca_fg_cart_message_section",CART_MSG_SECTION:`<div id="sca-promotion-glider" class="glider sca-promotion-glider">
                {{ sca_fg_cart_message_items_section }}
            </div>`,CART_MSG_ITEM_SECTION_ID:"#sca_fg_cart_message_items_section",CART_MSG_ITEM_SECTION:`<p class="content-promotion-message">
                {{ fg_cart_message }}
            </p>`,OLD_GIFT_THUMBNAIL_SECTION_ID:"#sca_fg_gift_thumbnail_section",OLD_GIFT_THUMBNAIL_SECTION:`<div class="sca-gift-thumbnail-title">{{ fg_gift_thumbnail_title }}</div>

            <div class="slide-container" id="fg-gift-thumbnail-title">
                <div class="glider-contain">
                    <div class="glider sca-list-gift-thumbnail">
                        {{ sca_fg_gift_thumbnail_items_section }}
                    </div>

                    <div class="{{ fg_check_show_narrow }}">
                        <span aria-label="Previous" class="glider-prev nav left-nav btn-nav-slide">\xAB</span>
                        <span aria-label="Next" class="glider-next nav right-nav btn-nav-slide">\xBB</span>
                    </div>
                    <div role="tablist" class="dots-thumbnail"></div>
                </div>
            </div>`,OLD_GIFT_THUMBNAIL_ITEMS_SECTION_ID:"#sca_fg_gift_thumbnail_items_section",OLD_GIFT_THUMBNAIL_ITEMS_SECTION:`<div class="d-flex product-item">
                <a class="gift-original-url" href="{{ fg_product_handle }}" target="_blank">
                    <img loading="lazy" class="product-item-thumbnail sca-gift-image" src="{{ fg_product_img }}"
                        data-type="{{ fg_offer_type }}" alt="{{ fg_product_img_alt }}"
                    >
                </a>
            </div>`,GIFT_THUMBNAIL_SECTION_ID:"#sca_new_fg_gift_thumbnail_section",GIFT_THUMBNAIL_SECTION:'<div class="fg-gift-thumbnail-container">{{ fg_gift_thumbnail_section }}</div>',GIFT_THUMBNAIL_ITEMS_SECTION_ID:"#sca_new_fg_gift_thumbnail_items_section",GIFT_THUMBNAIL_ITEMS_SECTION:`<div class="fg-gift-thumbnail-offer" data-fg-offer-id="{{ fg_offer_id }}">
                <div class="fg-gift-thumbnail-offer-header">
                    <div class="fg-gift-thumbnail-offer-time">
                        <div class="fg-gift-thumbnail-offer-time-title">{{ fg_offer_time_title }}</div>
                        <div class="fg-gift-thumbnail-offer-time-detail">{{ fg_offer_time_detail }}</div>
                    </div>
                    <div class="fg-gift-thumbnail-offer-title">{{ fg_offer_title }}</div>
                </div>
                <div class="fg-gift-thumbnail-offer-body">
                     <div class="glider-contain">
                        <div class="glider fg-gift-thumbnail-offer-slider">{{ fg_offer_body }}</div>
                    </div>
                </div>
                <div class="fg-gift-thumbnail-offer-footer">
                    <div class="fg-gift-thumbnail-offer-footer-quantity">{{ fg_offer_footer_total }}</div>
                    <div class="fg-gift-thumbnail-offer-footer-action">
                        <div class="fg-gift-thumbnail-btn glider-prev"></div>
                        <div class="fg-gift-thumbnail-btn glider-next"></div>
                  </div>
                </div>
            </div>`,GIFT_THUMBNAIL_SUB_ITEMS_SECTION_ID:"#sca_new_fg_gift_thumbnail_sub_items_section",GIFT_THUMBNAIL_SUB_ITEMS_SECTION:`<div class="d-flex product-item">
                <a class="gift-original-url" href="{{ fg_product_handle }}" target="_blank">
                    <img loading="lazy" class="product-item-thumbnail fg-gift-image" src="{{ fg_product_img }}"
                        data-type="{{ fg_offer_type }}" alt="{{ fg_product_img_alt }}"
                    >
                </a>
            </div>`,GIFT_THUMBNAIL_ITEMS_EXPIRED:`<div class="fg-gift-thumbnail-time-element day">{{ fg_time_day }}</div>
             <div class="fg-gift-time-extra">:</div>
             <div class="fg-gift-thumbnail-time-element hour">{{ fg_time_hour }}</div>
             <div class="fg-gift-time-extra">:</div>
             <div class="fg-gift-thumbnail-time-element minutes">{{ fg_time_minutes }}</div>
             <div class="fg-gift-time-extra">:</div>
             <div class="fg-gift-thumbnail-time-element second">{{ fg_time_second }}</div>`,GIFT_ICON_SECTION_ID:"#sca_fg_gift_icon_section",GIFT_ICON_SECTION:'<img loading="lazy" src="{{ fg_gift_icon }}" alt="{{ fg_gift_icon_alt }}" class="{{ fg_class_product_or_collection_page }}" />',TODAY_OFFER_SECTION_ID:"#sca_fg_today_offer_section",TODAY_OFFER_SECTION:`<div id="sca-today-offer-wrap" class="bogos-today-offer-v2">
                <div class="sca-fg-header">
                    <div class="sca-fg-header-title">
                        <span class="sca-fg-today-offer-title">{{ sca_fg_today_offer_title }}</span>
                        <span class="sca-fg-close-today-offer" aria-label="close" data-close>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#5e5873" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </span>
                    </div>
                    <span class="sca-fg-today-offer-subtitle">{{ sca_fg_today_offer_subtitle }}</span>
                </div>

                <div class="sca-fg-body">
                    <div class="sca-fg-offers"></div>
                </div>

                <div class="sca-fg-footer">
                    {{ sca_fg_today_offer_footer }}
                </div>
            </div>`,TODAY_OFFER_ITEM_SECTION_ID:"#sca_fg_today_offer_item_section",TODAY_OFFER_ITEM_SECTION:`<div class="sca-fg-offer {{sca_fg_offer_detail}}" data-fg-offer-id="{{ sca_fg_offer_id }}">
               <div class="sca-offer-header-container">
                  {{ bogos_today_offer_header }}
               </div>
               <div class="sca-offer-gift-products {{ check_show_gift_product }}">
                  {{ bogos_today_offer_gift_products }}
               </div>
               <span class="sca-offer-more-gift-products {{ check_show_more_product }}" data-bogos-offer-id="{{ sca_bogos_offer_id }}">
               {{ bogos_more_gift_product }}
               </span>
            </div>`,TODAY_OFFER_ITEM_HEADER_SECTION_ID:"#bogos_today_offer_item_header_section",TODAY_OFFER_ITEM_HEADER_SECTION:`<div class="sca-offer-info">
               <span class="sca-fg-icon-success sca-hide">
                  <svg class="sca-fg-icon-success-anim" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                     <circle class="sca-fg-icon-success-circle" cx="26" cy="26" r="25" fill="none"></circle>
                     <path class="sca-fg-icon-success-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"></path>
                  </svg>
               </span>
               <span class="sca-fg-icon-back-offer-detail">
                  <svg xmlns="http://www.w3.org/2000/svg" width="6" height="10" viewBox="0 0 6 10" fill="none">
                     <path fill-rule="evenodd" clip-rule="evenodd" d="M5.78033 0.46967C6.07322 0.762563 6.07322 1.23744 5.78033 1.53033L2.31066 5L5.78033 8.46967C6.07322 8.76256 6.07322 9.23744 5.78033 9.53033C5.48744 9.82322 5.01256 9.82322 4.71967 9.53033L0.719669 5.53033C0.426776 5.23744 0.426777 4.76256 0.719669 4.46967L4.71967 0.46967C5.01256 0.176777 5.48744 0.176777 5.78033 0.46967Z" fill="#8A8A8A"/>
                  </svg>
               </span>
               <div class="sca-offer-title-container">
                  <b class="sca-offer-title" data-sca-fg-today-offer-title-tooltip="{{ sca_fg_offer_title_tooltip }}" style="cursor: default">
                    {{ sca_fg_offer_title }}
                  </b>
                  <span class="sca-offer-subtitle {{ check_show_gift_notification }}">
                    {{ sca_fg_offer_subtitle }}
                  </span>
               </div>
            </div>
            <a href="{{ bogos_today_offer_link }}" class="{{ check_show_btn_redirect }} sca-today-offer-link">
               <div class="sca-offer-redirect-btn">{{ bogos_offer_link_title }}</div>
            </a>`,TODAY_OFFER_ITEM_HEADER_WITH_IMG_SECTION_ID:"#bogos_today_offer_item_header_with_img_section",TODAY_OFFER_ITEM_HEADER_WITH_IMG_SECTION:`<div class="sca-offer-info">
               <img loading="lazy" class="sca-img-offer" width="50" height="50" src="{{ sca_fg_offer_img }}" alt="">
               <div class="sca-offer-title-container">
                  <b class="sca-offer-title" data-sca-fg-today-offer-title-tooltip="{{ sca_fg_offer_title_tooltip }}" style="cursor: default">
                  {{ sca_fg_offer_title }}
                  </b>
                  <span class="sca-offer-subtitle {{ check_show_gift_notification }}">
                  {{ sca_fg_offer_subtitle }}
                  </span>
               </div>
            </div>
            <span class="sca-fg-icon-success sca-hide">
               <svg class="sca-fg-icon-success-anim" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                  <circle class="sca-fg-icon-success-circle" cx="26" cy="26" r="25" fill="none"></circle>
                  <path class="sca-fg-icon-success-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"></path>
               </svg>
            </span>
            <a href="{{ bogos_today_offer_link }}" class="{{ check_show_btn_redirect }} sca-today-offer-link">
               <div class="sca-offer-redirect-btn">{{ bogos_offer_link_title }}</div>
            </a>`,TODAY_OFFER_GIFT_PRODUCT_ID:"#bogos_today_offer_gift_product",TODAY_OFFER_GIFT_PRODUCT:`<div class="sca-gift-product">
               <img loading="lazy" class="sca-gift-product-img" src="{{ bogos_today_offer_gift_img }}" alt="{{ bogos_today_offer_gift_name }}">
               <div class="sca-gift-product-info">
                  <div class="sca-gift-product-title">
                     {{ bogos_today_offer_gift_name }}
                  </div>
                  <div class="sca-gift-variant-title {{ check_show_variant_name }}">
                     {{ bogos_today_offer_gift_variant_name }}
                  </div>
                  <div class="sca-gift-product-price">
                     <span class="sca-gift-product-discount-price">{{ bogos_today_offer_gift_discount_price }}</span>
                     <span class="sca-gift-product-original-price">{{ bogos_today_offer_gift_original_price }}</span>
                  </div>
                  <div class="sca-gift-product-variants-selected {{ check_show_selected_variant }}">{{ bogos_variants_selected }}</div>
               </div>
            </div>`,TODAY_OFFER_WIDGET_ID:"#sca_fg_today_offer_widget",TODAY_OFFER_WIDGET:`<img loading="lazy" id="sca-fg-today-offer-widget-img" src="{{ sca_fg_today_offer_widget }}" alt="fg-widget-today-offer" />
            <span class="sca-fg-title-icon-widget">{{ sca-fg-title-icon-widget-content }}</span>
            <span class="sca-fg-count-offers"></span>`,SELECT_PRODUCT_OPTION_ITEM_CUSTOM_SECTION:`<div class="bogos-select-option-custom-item bogos-option-default {{check_activate}}" data-option-name="{{bogos_option_name}}" data-option-value="{{bogos_option_value}}">
                <div class="bogos-option-value-title">
                    {{bogos_option_value_title}}
                </div>
              </div>`,SELECT_PRODUCT_OPTION_ITEM_WITH_COLOR_CUSTOM_SECTION:`<div class="bogos-select-option-custom-item bogos-option-color {{check_activate}}" data-option-name="{{bogos_option_name}}" data-option-value="{{bogos_option_value}}" style="{{bogos_option_color_container_style}}">
               <div class="bogos-option-color-item" style="{{bogos_option_color_style}}"></div>
               <div class="bogos-option-value-title {{check_show_title}}">
                   {{bogos_option_value_title}}
               </div>
            </div>`,SELECT_PRODUCT_OPTION_ITEM_WITH_IMAGE_CUSTOM_SECTION:`<div class="bogos-select-option-custom-item bogos-option-image {{check_activate}}" data-option-name="{{bogos_option_name}}" data-option-value="{{bogos_option_value}}" style="{{bogos_option_color_container_style}}">
                <img src="{{bogos_option_custom_data}}" style="{{bogos_option_image_style}}" alt="{{bogos_option_value}}">
                <div class="bogos-option-value-title {{check_show_title}}">
                    {{bogos_option_value_title}}
                </div>
               </div>`,SELECT_PRODUCT_OPTION_NAME_CONTAINER_SECTION:`<div class="bogos-select-option-name-container" data-option-name="{{bogos_option_name}}">
                 <div class="bogos-select-option-name">
                    {{bogos_option_name}}
                 </div>
                 <div class="bogos-select-option-items">
                     {{bogos_option_items}}
                 </div>
            </div>`},b={addToCart:async(e,t,i)=>{if(u.empty(i))return new Promise(s=>s({ok:!0}));let r=A.OFFER_TYPE.gift_func,o=i.map(s=>{let{bogos_item_properties:g}=FGSECOMAPP.variables.Shopify??{},n=g?.offers?.[s.offer_root]?.[s.variant_id]??g?.[s.variant_id],d=k.isSpecificOffer?{_bogos_trigger_id:s.offer_root,_bogos_trigger:`${A.TRIGGER_FUNC[r]}_${s.offer_root}`,_bogos_trigger_type:r}:{};return{quantity:s.quantity,id:s.variant_id,properties:{...d,...n}}});if(FGSECOMAPP.variables.isHeadless)return await W.addCart(o);let c=await u.fetch(e,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json",...t},body:JSON.stringify({items:o,...b.cartAttributes()})});if(t?.sca_add_gift){let s=e.match(B.cart);b.checkEventCart([`fetch-override:${s?.[0]}`]).then()}return c},handleAddGift:async(e,t,i)=>{try{i=`${i}`;let r=FGSECOMAPP.offers.find(n=>i===n.id),c=r.type===A.OFFER_TYPE.function?r.shopify_discount_settings?.code:null;console.info(`BOGOS track: add gift from slider {${e}} {${i}} {${r.type}}`);let s=FGSECOMAPP.arrOfferAdded.find(n=>i===n.belongs_to_offer?.toString()&&e===n.variant_id);s?s.quantity+=t:FGSECOMAPP.arrOfferAdded.unshift({variant_id:e,belongs_to_offer:i,quantity:t,code:c}),localStorage.setItem(FGSECOMAPP.variables.constants.sca_offers_added,u.convertObjToString(FGSECOMAPP.arrOfferAdded)),b.renderEventLoading("start");let g=await b.addToCart(`${FGSECOMAPP.variables.Shopify?.sca_add_url??"/cart/add.js"}?sca_add_gift`,{sca_add_gift:1},[{quantity:t,variant_id:e,offer_root:r.offer_root,offer_id:r.id}]);return g.ok&&await J.apply_discounts([c]),g.ok}catch{return!1}},addGiftToCart:async(e,t,i)=>{let{general:r}=FGSECOMAPP.fgAppearance?.gift_slider,{use_old_version:o,show_gift_type:c}=r??{};o===!1&&b.handleQuantityGiftAvailableSession("set",t,c==="offer"?i.split("_")[0]:void 0),i=i?.toString();let s=document.querySelector(`#fg-gift-items .btn-add-to-cart[data-variant='${e}']`),g=await b.handleAddGift(e,t,i);g?(s&&s.classList.remove("bogos-gift-adding"),s&&s.classList.add("bogos-gift-added"),v.renderSuccessAddGift(),await b.refreshCart([],!0)):s&&(s.innerHTML="Out of stock"),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.GIFT_ADDED,{detail:{gift:g}}))},processGiftsToCart:async(e,t,i)=>{try{let r=JSON.stringify(FGSECOMAPP.arrOfferAdded)!==i;if(u.empty(e)&&u.empty(t)&&!r)return!1;let o={},c={};FGSECOMAPP.cartItems?.filter(l=>u.checkCartItemIsGift(l))?.forEach(l=>{c[`${l.variant_id}_${l.properties?._bogos_trigger_id}`]={id:l.id,key:l.key,variant_id:l.variant_id,offer_id:l.properties?._bogos_trigger_id,offer_root:l.properties?._bogos_trigger_id,quantity:l.quantity},l.properties?._bogos_trigger_id&&l.key&&(o[l.key]=l.quantity)}),e=e?.filter(l=>!u.empty(l.variant_id)),e?.forEach(l=>{let _=`${l.variant_id}_${k.isSpecificOffer?l.offer_root:""}`,m=c[_]??{};c[_]={...m,...l,quantity:(m.quantity??0)+(l.quantity??1)}}),Object.keys(c)?.forEach(l=>{if(c[l]={...c[l],quantity:Math.max(c[l].quantity,0)},!k.isSpecificOffer&&!FGSECOMAPP.variables.isHeadless){let _=c[l]?.variant_id;o[_]=c[l]?.quantity+(o[_]??0),delete c[l];return}c[l]?.key&&(o[c[l]?.key]=c[l]?.quantity,delete c[l])});let s=Object.values(c),g=!u.empty(o)||!u.empty(c);if(!g&&!r)return!1;e?.forEach(l=>{let _=FGSECOMAPP.arrOfferAdded.find(m=>l.offer_id?.toString()===m.belongs_to_offer?.toString()&&l.variant_id===m.variant_id);_?_.quantity+=l.quantity:FGSECOMAPP.arrOfferAdded.unshift({variant_id:l.variant_id,belongs_to_offer:l.offer_id?.toString(),quantity:l.quantity,code:l.type===A.OFFER_TYPE.function?l.code:null})}),localStorage.setItem(FGSECOMAPP.variables.constants.sca_offers_added,u.convertObjToString(FGSECOMAPP.arrOfferAdded)),b.renderEventLoading("start");let n=!1,d=!u.empty(o),a=!u.empty(c),f=g?`sca_process_gifts${a?"_bogos-ignore":""}`:r?"sca_attr_cart":"sca_none";if(FGSECOMAPP.variables.isHeadless){let l=s.filter(m=>!m.id),_=Object.entries(o).map(([m,S])=>({id:m,quantity:S}));await W.updateCart(_).then(m=>n||=m.ok),await b.addToCart(null,null,l).then(m=>n||=m.ok)}else(d||r)&&await u.fetch(`${FGSECOMAPP.variables.Shopify?.sca_update_url??"/cart/update"}?${f}`,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json",sca_process_gifts:"1"},body:JSON.stringify({updates:o,...b.cartAttributes()})}).then(l=>n||=l.ok),a&&await b.addToCart(`${FGSECOMAPP.variables.Shopify?.sca_add_url??"/cart/add"}?${f.replace("_bogos-ignore","")}`,{sca_process_gifts:1},Object.values(c)).then(l=>n||=l.ok);return(a||d)&&await J.apply_discounts(FGSECOMAPP.arrOfferAdded.map(l=>l.code).filter(Boolean)),n&&e.length&&v.renderSuccessAddGift(),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.CART_AUTO_UPDATED,{detail:{arrGiftsAdd:e,arrGiftsRemove:t}})),FGSECOMAPP.variables.isCheckout&&location.reload(),n}catch(r){return b.renderEventLoading("end"),console.error("BOGOS track: Error processGiftsToCart",r),!1}},renderEventLoading:e=>{try{if(!FGSECOMAPP.variables.Shopify?.enable_process_offer_loading)return;let{checkout_btn_query:t}=FGSECOMAPP.QUERY_SELECTOR,i=[...t?.tool,...t?.integration,...t?.default].filter(Boolean).join(",");document.querySelectorAll(i).forEach(r=>{M.customLoading(e,r).then()})}catch{}},cartAttributes:()=>{if(FGSECOMAPP.variables.Shopify?.do_not_add_freegift_attribute)return;let e=[];if(!u.empty(FGSECOMAPP.arrOfferAdded)){e.push("SECOMAPP_FREEGIFT");let{bogos_item_properties:t}=FGSECOMAPP.variables.Shopify??{};e.push(...t?.cart??[]);for(let i of FGSECOMAPP.arrOfferAdded){let{sub_conditions:r}=FGSECOMAPP.offers.find(c=>c.id===i.belongs_to_offer)??{},{specific_link_address:o}=r??{};u.empty(o)||e.push(o)}}return{attributes:{__freegift_attributes:e.toString(),__bogos_tracking:u.aggregateArrOfferAddedIds(FGSECOMAPP.arrOfferAdded)?.sort().join("-")}}},priceCartItem:e=>{let{final_price:t,price:i}=e??{};try{return e[FGSECOMAPP.variables.Shopify?.sca_fg_price]??t??i}catch{return t??i}},filterProductsSatisfyPackOfProducts:(e,t,i)=>{let r=t.product_narrow[0]??{track_pack_type:null},o=r.track_pack_type;if(u.empty(o))return e;let c=!0,s=[],g=Object.values(r.value);o==="variant"&&(g=g.map(a=>a.variants??a.variant).flat());let n=o==="variant"?"variant_id":"product_id",d=e.reduce((a,f)=>{let l=f[n],_=a[l]??0;return a[l]=_+f.quantity,a},{});for(let a of g){let f=d[a.id]??0;if(a.quantity>f){c=!1,s=[];break}s.push(Math.floor(f/a.quantity))}return i.multiply_max=0,c?(i.multiply_max=s.length>0?Math.min(...s):0,e):[]},filterProductsMatchConditionsWithCalculateForOtherRules:(e,t)=>e?.map(i=>{if(typeof i.cal_gift_for_other_rules<"u"){let r=FGSECOMAPP.arrOfferAdded?.filter(c=>c.variant_id===i.variant_id);if(r?.reduce((c,s)=>c+s.quantity,0)===i.quantity){let c=r?.filter(s=>{if(s.belongs_to_offer?.toString()===t.toString())return!1;let n=(FGSECOMAPP.offers?.find(a=>a.id?.toString()===s.belongs_to_offer?.toString())).gift_settings??{},d=b.priceCartItem(i);return n.cal_gift_for_other_rules&&d>0})?.reduce((s,g)=>s+g.quantity,0);return{...i,cal_gift_for_other_rules:c>0,quantity:c??0}}return{...i,cal_gift_for_other_rules:!1,quantity:0}}return{...i}})??[],filterProductsMatchConditionsWithSettings:(e,t,i,r)=>{let o=FGSECOMAPP.fgSettings?.compare_gift_price_with_product,c=FGSECOMAPP.fgSettings?.not_show_gift_if_already_on_cart;r??=FGSECOMAPP.cartItems;let s=e,g=i.gift_products?.map(f=>f.original_product_shopify_id);if(c){let f=s.filter(_=>!u.checkCartItemIsGift(_)),l=g.filter(_=>f.every(m=>m.product_id!==_));s=l.length?s.filter(_=>!l?.includes(_.product_id)):[]}let n=s;if(o){s=e.sort((h,p)=>b.priceCartItem(h)-b.priceCartItem(p));let f=i.gift_items.map(h=>h?.compare_gift_price??0);s=s.filter(h=>f.some(p=>p<=b.priceCartItem(h)/L)),n=JSON.parse(JSON.stringify(s));let l=i.giftsAdded.sort((h,p)=>p?.compare_gift_price-h?.compare_gift_price).map(h=>({...h})),_=l.reduce((h,p)=>h+p.quantity,0),m=b.calculateMaxGifts(s,t,i),S=Math.max(m-_,0),y=t.is_multiply?i.gift_settings.number_of_gift_can_receive:1;if(n.filter(h=>h.quantity>0).forEach(h=>{h.quantity*=y;let p=b.priceCartItem(h)/L;l.filter(E=>E.quantity>0&&E?.compare_gift_price<=p).forEach(E=>{if(!h.quantity)return 0;let C=h.quantity-E.quantity;E.quantity=Math.max(-C,0),h.quantity=Math.max(C,0)})}),i.giftsAddedInvalid=l.filter(h=>h.quantity>0),!t.is_multiply&&S>0){let[h]=n.slice(-1);!u.empty(h)&&(h.quantity+=S)}n=n.filter(h=>h.quantity>0)}s=s.filter(f=>f.quantity>0);let d=r.map(f=>f.product_id),a=[];return FGSECOMAPP.fgSettings?.select_one_gift_price&&(a=r.filter(f=>u.checkCartItemIsGift(f)).map(f=>f.variant_id)),i.gifts_valid=JSON.parse(JSON.stringify(i.gift_products))?.filter(f=>(i.is_offer_shipping&&(f.variants=f.variants.filter(l=>FGSECOMAPP.productsByID?.[l.product_shopify_id]?.variants?.find(_=>_.id===l.variant_shopify_id)?.available)),f.variants=f.variants.filter(l=>!a.includes(l.variant_shopify_id)),c&&d?.includes(f.original_product_shopify_id)?!1:(o&&(f.variants=f.variants.filter(l=>n.some(_=>l.compare_gift_price<=b.priceCartItem(_)/L))),!u.empty(f.variants)))),s},countTotalMoneyAmount:e=>e.filter(t=>t.cal_gift_for_other_rules===void 0||t.cal_gift_for_other_rules===!0).reduce((t,i)=>t+i.quantity*b.priceCartItem(i),0)/L,countTotalProducts:e=>e.filter(t=>t.cal_gift_for_other_rules===void 0||t.cal_gift_for_other_rules).reduce((t,i)=>t+i.quantity,0),calculateMaxGifts:(e,t,i)=>{let r=0,o=0;if(t.unit==="money"?(o=b.countTotalMoneyAmount(e),i.count_down_value=Math.max(t.min_amount-o,0)):t.unit==="number_of_products"&&(o=b.countTotalProducts(e),i.count_down_quantity=Math.max(t.min_amount-o,0)),o>=t.min_amount&&(t.max_amount===null||o<=t.max_amount)){let c=i.multiply_max??Math.floor(o*100/(t.min_amount*100));r=i.gift_settings.number_of_gift_can_receive*(t.is_multiply?c:1)}return r},countMaxGiftsCanGet:(e,t,i)=>{let r=u.findProductsMatchConditions(t,e,i.sub_conditions?.subscription_products);return r=b.filterProductsMatchConditionsWithCalculateForOtherRules(r,e.offer_id),r=b.filterProductsMatchConditionsWithSettings(r,e,i,t),r=b.filterProductsSatisfyPackOfProducts(r,e,i),b.calculateMaxGifts(r,e,i)},checkEachConditionList:(e,t)=>{let i={},r=[],o=0;return t.offer_conditions.map(c=>{let s=b.countMaxGiftsCanGet(c,e,t);s!==0&&(o=s),r.push(s>0)}),i.max_gifts_can_get=o,i.condition_result=r,i},isSatisfyCondition:(e,t)=>{let i=!1;return e.length===1?i=e[0]:e.length===2&&(t==="and"&&(i=e[0]&&e[1]),t==="or"&&(i=e[0]||e[1])),i},countGiftAvailableFromOffer:(e,t)=>{let i=b.checkGiftAlreadyAddedToCart(e,t);t.giftsAdded=i;let r=b.checkEachConditionList(e,t),o=b.isSatisfyCondition(r.condition_result,t.condition_relationship);if(o){let c=i.filter(s=>s.belongs_to_offer?.toString()===t.id?.toString()).reduce((s,g)=>s+g.quantity,0);r.max_gifts_can_get=r.max_gifts_can_get-c,t.giftsAdded=i,t.giftsAvailable=r.max_gifts_can_get}else t.giftsAdded=i,t.giftsAvailable=0;return!u.empty(FGSECOMAPP.variables.maxOfferPriority)&&t.priority>FGSECOMAPP.variables.maxOfferPriority&&(o=!1),t.stop_lower_priority&&o?FGSECOMAPP.variables.maxOfferPriority=t.priority:t.stop_lower_priority&&!o&&t.priority===FGSECOMAPP.variables.maxOfferPriority&&!u.empty(i)&&(FGSECOMAPP.variables.maxOfferPriority=null),t.isReachConditions=o,t},checkGiftAlreadyAddedToCart:(e,t)=>{let i=e?.map(s=>s.variant_id);FGSECOMAPP.arrOfferAdded=FGSECOMAPP.arrOfferAdded.filter(s=>i?.includes(s.variant_id));let r=t.gift_items.map(s=>s.variant_shopify_id),o={};t.gift_items.filter(s=>o[s.variant_shopify_id]={fg_original_compare_at_price:s.original_compare_at_price,fg_original_price:s.original_price,compare_gift_price:s.compare_gift_price});let c=FGSECOMAPP.arrOfferAdded.filter(s=>s.belongs_to_offer?.toString()===t.id?.toString())?.map(s=>s.variant_id);return e.filter(s=>{let g=u.checkCartItemIsGift(s),n=s.properties?._bogos_trigger_id,d=g&&(n===t.offer_root||!n);return g&&(s.cal_gift_for_other_rules=!1),r.includes(s.variant_id)&&c.includes(s.variant_id)&&d}).map(s=>{let g=t.gift_settings;s.cal_gift_for_other_rules=g.cal_gift_for_other_rules,s.belongs_to_offer=t.id?.toString();let n=!u.empty(s.properties?._bogos_trigger_id),d=FGSECOMAPP.arrOfferAdded?.filter(a=>a.belongs_to_offer?.toString()!==t.id?.toString()&&s.variant_id===a.variant_id)?.reduce((a,f)=>a+f.quantity,0);return{...s,quantity:s.quantity-(n?0:d),...o[s.variant_id]}})},filterGiftProducts:e=>{let t=e.giftsAdded.filter(i=>i.belongs_to_offer?.toString()!==e.id?.toString()).map(i=>i.product_id);return Object.values(e.gifts_valid).filter(i=>!t.includes(i.product_shopify_id))},checkAutoAddGift:(e,t)=>{try{let i=[],{offer:r}=t,{code:o}=r?.shopify_discount_settings??{},c=r?.type;o=c===A.OFFER_TYPE.function?o:null;let s=t.gifts,g=s.reduce((a,f)=>a+f.variants.length,0);if(!e.auto_add_gift&&!r.is_offer_shipping||g<=0)return[];let n=t.offer?.gift_settings?.auto_add_all_gifts,d=t.offer?.gift_should_the_same??{};if(d.status&&d.type==="variant"){let a=s[0].variants[0];a.price===0&&(i.push({variant_id:a.variant_shopify_id,quantity:t.giftsAvailable,offer_id:t.id,offer_root:r.offer_root,type:c,code:o}),console.log(`BOGOS track: variant auto add gift {${a.variant_shopify_id}} {${a.variant_title}} {${t.id}} {${c}}`))}else if(n){let a=(t?.giftsAvailable??0)/g;s.forEach(f=>f.variants?.forEach(l=>i.push({variant_id:l.variant_shopify_id,quantity:a,offer_id:t.id,offer_root:r.offer_root,type:c,code:o}))),console.log(`BOGOS track: auto add all gifts from {${t.id}} {${c}}`)}else if(g===1){let a=s[0].variants[0];a.price===0&&(i.push({variant_id:a.variant_shopify_id,quantity:t.giftsAvailable,offer_id:t.id,offer_root:r.offer_root,type:c,code:o}),console.log(`BOGOS track: auto add gift: {${a.variant_shopify_id}} {${a.variant_title}} {${t.id}} {${c}}`))}return i}catch(i){return console.error("BOGOS track: Error checkAutoAddGift",i),[]}},checkOfferWithSubCondition:(e,t)=>{let i={},{specific_link_address:r,customer_tags:o,customer_locations:c,customer_order_history:s,mobile_app_channel:g,markets:n}=e.sub_conditions;if(u.empty(r)||(i.specific_link_address=FGSECOMAPP.variables.sca_fg_codes?.includes(r)),!u.empty(o)){let{value_customer_tags:f,type_customer_tags:l}=o??{},_=f?.some(m=>t.customer.tags?.includes(m));i.customer_tags=l==="include"?_:!_}if(!u.empty(c)){let{value_customer_locations:f,type_customer_locations:l}=c??{},_=f?.includes(FGSECOMAPP.customerLocation);i.customer_locations=l==="include"?_:!_}if(!u.empty(s)){let f=!0,{order_created_from:l,total_spend_on_order_history:_,total_spent_on_last_order:m,number_of_order:S,have_not_got_gift_from_this_offer:y}=s??{},h=t.customer.orders??[];if(l){let p=Date.parse(l)/1e3;h=h.filter(E=>E.created_at>=p&&["paid","partially_paid"].includes(E.financial_status))}if(!u.empty(_)&&(_.min_amount!==0||_.max_amount!==0)){let{min_amount:p,max_amount:E}=_??{},C=h.reduce((P,G)=>P+G.total_price,0)/L;f&=(C>=p||!p)&&(C<=E||!E)}if(!u.empty(m)&&(m.min_amount!==0||m.max_amount!==0)){let p=(t.customer.last_total??0)/L,{min_amount:E,max_amount:C}=m??{};f&=h.length>0&&(p>=E||!E)&&(p<=C||!C)}if(!u.empty(S)){let{min_amount:p,max_amount:E}=S??{},C=!(p!==0||E!==0),P=h.length;f&=C?u.empty(h):(P>=p||!p)&&(P<=E||!E)}if(y){let p=t.customer.freegifts_v2??[],E=e.gift_items.map(G=>[`${G.variant_shopify_id}`,`${G.original_variant_shopify_id}_${10*(G.original_price-G.price)*10}`,`${G.original_variant_shopify_id}_${10*(G.original_compare_at_price-G.price)*10}`]).flat(),C=p.filter(({gift_item:G})=>E.includes(G)),P=[...new Set(C.map(({order_id:G})=>G))].length>=Number(y);f&=!P}i.customer_order_history=f}let{sale_channels:d,work_with_only_mobile_app:a}=g??{};if(i.sale_channels=a===!1||(d??[]).includes("online_store")||u.empty(d),!u.empty(n)){let{market:f}=FGSECOMAPP.variables.Shopify??{},{type:l,value:_}=n??{},m=u.getIntShopifyId(f?.id),S=_?.includes(`gid://shopify/Market/${m}`);i.markets=l!=="include"?!S:S}return Object.values(i).every(f=>f)},processCartWithOffers:(e,t,i)=>{let r=[],o,c=[],s=[],g=[];for(let n of t){let d=b.countGiftAvailableFromOffer(e,n),a=!d.isReachConditions||d.giftsAvailable<0,f=d.giftsAvailable>0&&d.gift_settings?.auto_add_all_gifts&&FGSECOMAPP.fgSettings?.auto_add_gift;if((a||f)&&d.giftsAdded?.forEach(l=>{s.push({variant_id:l.variant_id,quantity:l.quantity,offer_id:n.id,key:l.key,type:n.type})}),!a){if(d.giftsAvailable===0){let l={};d.giftsAdded?.forEach(_=>{l[_.variant_id]=(l?.[_.variant_id]??0)+_.quantity}),FGSECOMAPP.arrOfferAdded?.filter(_=>n.id?.toString()===_.belongs_to_offer?.toString()).forEach(_=>_.quantity=l[_.variant_id]??_.quantity);continue}(n.sub_conditions&&b.checkOfferWithSubCondition(n,SECOMAPP)||u.empty(n.sub_conditions))&&r.push(n)}}if(e?.filter(n=>u.checkCartItemIsGift(n)&&u.empty(n.belongs_to_offer)).forEach(n=>{s.push({variant_id:n.variant_id,quantity:n.quantity,offer_id:n.properties?._bogos_trigger_id,key:n.key})}),i||u.empty(s)){let n={};r.map(d=>({id:d.id,offerName:d.offer_name,offerPriority:d.priority,stopLowerPriority:d.stop_lower_priority,gifts:b.filterGiftProducts(d),giftsAvailable:d.giftsAvailable,giftsAdded:d.giftsAdded,isReachConditions:d.isReachConditions,offer_root:d.offer_root,offer:d}))?.forEach(d=>{let a=b.checkAutoAddGift(FGSECOMAPP.fgSettings,d);if(a?.length>0){c.push(...a);return}v.handleCheckHiddenGiftSlider(`FGSECOMAPP_HIDDEN_GIFT_OFFER_${d.offer_root}`)||d.gifts.forEach(f=>{n[f.product_shopify_id]={...f,belongs_to_offer:d.id?.toString()},g[d.offer_root]=[...g[d.offer_root]??[],{...f,belongs_to_offer:d.id?.toString()}]})}),o=Object.values(n)??[]}return{arrGiftsAdd:c,arrGiftsRemove:s,arrGiftsData:o,giftsOfferData:g}},processGiftsInvalid:(e,t)=>{let i=new Set;e?.forEach(o=>i.add(o.offer_id)),i.forEach(o=>{let c=FGSECOMAPP.offers?.find(d=>d.id?.toString()===o?.toString());if(u.empty(c)||!c.isReachConditions){FGSECOMAPP.arrOfferAdded=FGSECOMAPP.arrOfferAdded?.filter(d=>d.belongs_to_offer?.toString()!==o?.toString());return}let{auto_add_all_gifts:s}=c?.gift_settings??{};if(c.giftsAvailable>=0&&!s)return;let g=[],n=FGSECOMAPP.arrOfferAdded?.filter(d=>d.belongs_to_offer?.toString()===o?.toString())??[];if(s)g=g.concat([...n]),c.giftsAvailable=0;else{FGSECOMAPP.fgSettings?.compare_gift_price_with_product&&!u.empty(c.giftsAddedInvalid)&&c.giftsAddedInvalid.forEach(d=>{let a=FGSECOMAPP.arrOfferAdded.find(l=>l.belongs_to_offer?.toString()===c.id?.toString()&&d.variant_id===l.variant_id);if(u.empty(a))return;let f=a.quantity-d.quantity;c.giftsAvailable+=d.quantity,f>0?a.quantity=f:(a.quantity=0,g.push({...a}))});for(let d of n){if(c.giftsAvailable>=0)break;c.giftsAvailable+=d.quantity,c.giftsAvailable<=0?g.push({...d}):(d.quantity=c.giftsAvailable,c.giftsAvailable=0)}}g?.forEach(d=>{FGSECOMAPP.arrOfferAdded=FGSECOMAPP.arrOfferAdded?.filter(a=>d.variant_id!==a.variant_id||d.belongs_to_offer?.toString()!==a.belongs_to_offer?.toString())})});let r={};return t?.filter(o=>{if(u.checkCartItemIsGift(o)){let c=o.properties?._bogos_trigger_type===A.OFFER_TYPE.gift_func&&!u.empty(o.properties?._bogos_trigger_id),s=FGSECOMAPP.arrOfferAdded?.filter(n=>o.variant_id===n.variant_id),g=o.variant_id;c&&(g=`${o.variant_id}_${o.belongs_to_offer}`,s=s.filter(n=>o.belongs_to_offer===n.belongs_to_offer)),o.quantity=s?.reduce((n,d)=>n+d.quantity,0)??0,o.quantity-=r[g]??0,r[g]??=o.quantity}return o.quantity>0})??[]},checkAllOffers:async(e,t)=>{let i=JSON.stringify(FGSECOMAPP.arrOfferAdded),{arrGiftsAdd:r,arrGiftsRemove:o,arrGiftsData:c,giftsOfferData:s}=b.processCartWithOffers(e,t,!1),g=b.processGiftsInvalid(o,e);if(!u.empty(o)){let d=b.processCartWithOffers(g,t,!0);b.processGiftsInvalid(d?.arrGiftsRemove,e),r=d?.arrGiftsAdd,o=o?.concat(d?.arrGiftsRemove)??[],c=d?.arrGiftsData,s=d?.giftsOfferData}let n=await b.processGiftsToCart(r,o,i);return n||it.apply_discounts_shipping(),{giftsOfferData:s,arrGiftsData:c,isUpdated:n&&(!u.empty(r)||!u.empty(o))}},filterOfferGiftSetting:async()=>{try{let e=JSON.parse(JSON.stringify(window.fgData?.offers??[]));for(let n in FGSECOMAPP.productsByID)u.empty(FGSECOMAPP.productsByID[n]?.id)&&delete FGSECOMAPP.productsByID[n];FGSECOMAPP.variables.conditions.locations&&await u.getCustomerLocation();let t=[],i=FGSECOMAPP.fgSettings.offer_process??A.OFFER_TYPE.cloned;e=e?.map(n=>{n.is_offer_shipping=n.gift_settings.discount_method===A.DISCOUNT_TYPE.shipping,n.type_source=n.type,n.type=n.is_offer_shipping?A.OFFER_TYPE.function:i;let d=b.reorderGiftProducts(n),a=d.reduce((f,l)=>((l.variants||[]).forEach(_=>{f[_.original_variant_shopify_id]=_.thumbnail}),f),{});return{...n,id:n.id.toString(),offer_root:(n.offer_root??n.id).toString(),gift_products:d,gift_items:n.gift_items?.map(f=>{let l={};return n.type===A.OFFER_TYPE.function&&!n.is_offer_shipping&&(FGSECOMAPP.variables.giftIdsFunction.push(f.original_variant_shopify_id),l={product_shopify_id:f.original_product_shopify_id,variant_shopify_id:f.original_variant_shopify_id}),{...f,...l,thumbnail:a[f.original_variant_shopify_id]??f?.thumbnail}})}});let r=(n,d,a,f)=>{try{let{type:l,value:_,giftItems:m,giftProducts:S}=d;n.offer_conditions[0].product_narrow=[{type:l,value:{[a]:{..._[a],...!u.empty(f)&&{variants:[{...f}]}}}}],n.gift_items=m.filter(h=>h.original_product_shopify_id?.toString()===a?.toString()&&(u.empty(f)||f?.id===h.original_variant_shopify_id)),n.gift_products=S.filter(h=>h.original_product_shopify_id?.toString()===a?.toString()),n.gift_products[0].variants=[...n.gift_items];let y=n.gift_settings.number_of_gift_can_receive;return n.gift_settings.auto_add_all_gifts&&(y=n.gift_items.length),JSON.parse(JSON.stringify({...n,gift_settings:{...n.gift_settings,number_of_gift_can_receive:y},id:`${n.id}_${_[a].id}_${f?.id??""}`,offer_root:`${n.id}`}))}catch(l){console.warn(`BOGOS track: Error product-${a}`,l)}};e.forEach(n=>{try{let d=JSON.parse(JSON.stringify(n)),a=n.gift_should_the_same??{};if(!a?.status||d.is_offer_shipping)return;let f=n.offer_conditions[0]?.product_narrow,l={type:f[0]?.type,value:f[0]?.value,giftItems:[...n.gift_items],giftProducts:[...n.gift_products]};for(let _ in l.value){if(a?.type==="product"){t.push(r(d,l,_));continue}if(a?.type==="variant"){let{variant:m,variants:S}=l.value?.[_]??{};(S??m)?.forEach(y=>t.push(r(d,l,_,y)))}}}catch(d){console.error("BOGOS track: Error prepareOfferShouldBeTheSame",d)}}),e=e?.filter(n=>!n?.gift_should_the_same?.status||n.is_offer_shipping)?.concat(t.filter(n=>n)),e=e?.filter(n=>{if(!u.checkValidTimeOffer(n.start_time,n.end_time))return!1;let{customer_order_history:d,customer_tags:a}=n.sub_conditions??{},{no_login:f}=a??{},l=!u.empty(d)||!(f??!0),{total_spend_on_order_history:_,total_spent_on_last_order:m}=d??{};if(!u.empty(_)){let{min_amount:h,max_amount:p}=_??{};d.total_spend_on_order_history={min_amount:h?u.convertMultiCurrency(h):void 0,max_amount:p?u.convertMultiCurrency(p):void 0}}if(!u.empty(m)){let{min_amount:h,max_amount:p}=m??{};d.total_spent_on_last_order={min_amount:h?u.convertMultiCurrency(h):void 0,max_amount:p?u.convertMultiCurrency(p):void 0}}if(n.sub_conditions&&(!b.checkOfferWithSubCondition(n,SECOMAPP)||l&&u.empty(SECOMAPP.customer.email)))return!1;if(n.is_offer_shipping)return n.gift_settings={...n.gift_settings,number_of_gift_can_receive:1,cal_gift_for_other_rules:!1},!0;let S={...FGSECOMAPP.productsByID},y=!1;if(FGSECOMAPP.fgSettings.sync_quantity===A.SYNC_QUANTITY.stop_offer){n.gift_items=n?.gift_items.filter(p=>S[p.original_product_shopify_id]?.variants?.find(E=>E.id===p.original_variant_shopify_id)?.available)??[];let h=n.gift_items?.map(p=>p.variant_shopify_id);n.gift_products=n?.gift_products?.filter(p=>(p.variants=p?.variants?.filter(E=>h?.includes(E.variant_shopify_id)),p?.variants?.length>0)),y=!0}else if(FGSECOMAPP.fgSettings.manual_input_inventory){n.gift_items=n?.gift_items.filter(p=>S[p.product_shopify_id]?.variants?.find(E=>E.id===p.variant_shopify_id)?.available);let h=n.gift_items?.map(p=>p.variant_shopify_id);n.gift_products=n?.gift_products?.filter(p=>(p.variants=p?.variants?.filter(E=>h?.includes(E.variant_shopify_id)),p?.variants?.length>0)),y=!0}return y&&n.gift_settings?.auto_add_all_gifts&&(n.gift_settings.number_of_gift_can_receive=n.gift_items?.length),y?n.gift_items&&n.gift_items.length>0:!0});let o=FGSECOMAPP?.fgSettings?.cal_gift_discount==="compare_at_price"?"original_compare_at_price":"original_price",c=FGSECOMAPP.fgSettings?.compare_gift_price_with_product,s=c==="compare_at_price"?"original_compare_at_price":"original_price",g={};return e=e?.map(n=>{let d=n.type===A.OFFER_TYPE.function,a=n.gift_items.map(l=>{let _=FGSECOMAPP.productsByID?.[l.product_shopify_id]?.variants?.find(p=>p.id===l.variant_shopify_id)??{},m=FGSECOMAPP.productsByID?.[l.original_product_shopify_id]?.variants?.find(p=>p.id===l.original_variant_shopify_id)??{},S=m?.price?m.price/L:null,y=g[l.original_variant_shopify_id]??={original_price:S,original_compare_at_price:m?.compare_gift_price?m.compare_gift_price/L:S},h=g[l.variant_shopify_id]??={price:_?.price?_?.price/L:null};return l.price=(d?null:h?.price)??u.convertMultiCurrency(l.price),l.cal_gift_price=y?.[o]??u.convertMultiCurrency(u.empty(l[o])?l?.original_price:l[o]),c&&(l.compare_gift_price=y?.[s]??u.convertMultiCurrency(u.empty(l[s])?l?.original_price:l[s])),l.original_product_shopify_id});n.gift_products=n.gift_products?.filter(l=>(l.variants?.forEach(_=>{let m=g[_.original_variant_shopify_id]??{},S=g[_.variant_shopify_id]??{};_.price=(d?null:S?.price)??u.convertMultiCurrency(_.price),_.cal_gift_price=m?.[o]??u.convertMultiCurrency(u.empty(_[o])?_?.original_price:_[o]),c&&(_.compare_gift_price=m?.[s]??u.convertMultiCurrency(u.empty(_[s])?_?.original_price:_[s]))}),a.includes(l.original_product_shopify_id)));let{currency:f}=FGSECOMAPP.variables.Shopify??{};return n.offer_conditions?.forEach(l=>{if(l.unit==="money"){let _=l?.other?.currencies?.find(m=>m.currency===f?.active);l.min_amount=_?.min_amount??u.convertMultiCurrency(l.min_amount),l.max_amount=_?.max_amount??(u.empty(l.max_amount)?l.max_amount:u.convertMultiCurrency(l.max_amount))}}),{...n}})?.sort((n,d)=>n.priority-d.priority),FGSECOMAPP.variables.giftIdsFunction=[...new Set(FGSECOMAPP.variables.giftIdsFunction)],FGSECOMAPP.variables.maxTodayOfferPriority=Math.min(...e.map(n=>n.priority)),e}catch(e){return console.error("BOGOS track: filterOfferGiftSetting",e),[]}},getInfoCloneProducts:async e=>{try{let t=FGSECOMAPP.fgAppearance?.select_variant?.type==="option",i=[],r=[],o={sync:[],cache:[]},c=[],{sync_quantity:s,manual_input_inventory:g}=FGSECOMAPP?.fgSettings??{};window.fgData?.offers?.forEach(n=>{let d=[],a=[],f={sync:[],cache:[]},l=[],_=n.gift_settings.discount_method===A.DISCOUNT_TYPE.shipping;n.gift_products.forEach(m=>{let S=m.clone_product_handle??null,y=m.original_product_handle??null,h=m.original_product_shopify_id??null,p=m.product_shopify_id??null;l.push(m.original_product_shopify_id??null),(_||t)&&(d.push(S),f.sync.push(p)),s===A.SYNC_QUANTITY.stop_offer?(d.push(y),a.push(S),f.sync.push(h),f.cache.push(p)):g?(d.push(e?y:S),a.push(e?S:y),f.sync.push(e?h:p),f.cache.push(e?p:h)):(a.push(S,y),f.cache.push(h,p))}),i.push(...d),r.push(...a),o.sync.push(...f.sync),o.cache.push(...f.cache),c.push(...l)}),i=i.filter(n=>!u.empty(n)),r=r.filter(n=>!u.empty(n)),o={sync:o.sync.filter(n=>!u.empty(n)),cache:o.cache.filter(n=>!u.empty(n))},c=c.filter(Boolean),await H.cacheProducts(i,{"sca-offer-search":"1"},async()=>{console.info(`BOGOS track: offer:sync-quantity:${Date.now()}`)},{handles:i,ids:o.sync}),H.cacheProducts(r,{"sca-product-cache":"1"},()=>{console.log(`BOGOS track: product-cached:${Date.now()}`)},{handles:r,ids:o.cache}).then(),F.syncStarRating(c).then()}catch(t){console.error("BOGOS track: getInfoCloneProducts",t)}},validateArrOfferAdded:e=>{let{sca_offers_added:t}=FGSECOMAPP.variables.constants;try{u.empty(e)?(FGSECOMAPP.arrOfferAdded=[],localStorage.setItem(t,u.convertObjToString(FGSECOMAPP.arrOfferAdded))):FGSECOMAPP.arrOfferAdded=u.convertStringToObj(localStorage.getItem(t))}catch(c){FGSECOMAPP.arrOfferAdded=e.filter(s=>u.checkCartItemIsGift(s)).map(s=>({variant_id:s.variant_id,key:s.key,belongs_to_offer:s.properties?._bogos_trigger_id,quantity:s.quantity})),FGSECOMAPP.variables.failedParseArrOffersAdded=!0,console.warn("BOGOS track: Failed parse offer added",c)}let i={};FGSECOMAPP.offers?.forEach(c=>{i[c.id]=c?.gift_items?.map(s=>s.variant_shopify_id)});let r=Object.keys(i);FGSECOMAPP.arrOfferAdded=FGSECOMAPP.arrOfferAdded?.filter(c=>r?.includes(c.belongs_to_offer?.toString())&&i[c.belongs_to_offer?.toString()].includes(c.variant_id));let o={};FGSECOMAPP.arrOfferAdded?.forEach(c=>{let s=o[`${c.belongs_to_offer}_${c.variant_id}`]??{};o[`${c.belongs_to_offer}_${c.variant_id}`]={...c,belongs_to_offer:c.belongs_to_offer?.toString(),quantity:(s?.quantity??0)+(c?.quantity??0)}}),FGSECOMAPP.arrOfferAdded=Object.values(o),localStorage.setItem(t,u.convertObjToString(FGSECOMAPP.arrOfferAdded))},refreshCart:async(e,t,i={})=>{b.arrSaveAllFetch=[];let{isCartPage:r,isCheckout:o}=FGSECOMAPP.variables;t&&(r||o)&&location.reload(),t&&F.renderCart().then(()=>b.renderEventLoading("end")),setTimeout(function(){v.fetchRoot(e,i)},250)},arrSaveAllFetch:[],checkEventCart:async(e,t)=>{try{b.arrSaveAllFetch.push(e[0]),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.START_PROCESS_CART,{detail:{events:b.arrSaveAllFetch,event:e}})),u.empty(t)&&await u.fetchInfoCartUpdate();let{giftsOfferData:i,arrGiftsData:r,isUpdated:o}=await b.checkAllOffers(FGSECOMAPP.cartItems,FGSECOMAPP.offers);FGSECOMAPP.renderPromotionMessage(FGSECOMAPP.offers),console.info("BOGOS track: cart-events",[...b.arrSaveAllFetch],e[0]),await b.refreshCart(r,o||B.render_cart.test(e[0]),i),r?.length||(b.handleQuantityGiftAvailableSession("remove"),document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList?.remove("sca-is-visible-fg")),v.handleCheckedTodayOffer(),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_GIFT_OFFER_CHECK));let{isCartPage:c,isCheckout:s}=FGSECOMAPP.variables,g=e[0]==="bogos:checkout";return o&&(c||s||g)&&(b.arrSaveAllFetch=[],location.reload()),["bogos:rollback"].includes(e[0])||document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.END_PROCESS_CART,{detail:{events:b.arrSaveAllFetch,event:e}})),FGSECOMAPP.cartItems}catch(i){console.error("BOGOS track: Error check cart event",i)}},init:async(e,t,i)=>{document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_FG_START));let{using_draft_order:r}=FGSECOMAPP?.fgSettings??{};r&&(FGSECOMAPP.fgSettings.sync_quantity=A.SYNC_QUANTITY.stop_offer);let o=FGSECOMAPP.fgAppearance?.select_variant?.type==="option",c=FGSECOMAPP.variables.conditions.function;c&&(FGSECOMAPP.fgSettings.manual_input_inventory=!0,FGSECOMAPP.fgSettings.not_show_gift_if_already_on_cart=!1);let{sync_quantity:s,manual_input_inventory:g}=FGSECOMAPP?.fgSettings??{},n=s===A.SYNC_QUANTITY.stop_offer||g;i||(n||o?await b.getInfoCloneProducts(c):b.getInfoCloneProducts(c).then()),FGSECOMAPP.offers=await b.filterOfferGiftSetting(),typeof t=="function"&&t(),v.filterPageDisplay(FGSECOMAPP.fgAppearance?.today_offer?.pages_display)&&!FGSECOMAPP.variables?.isTodayOfferBooster&&v.renderTodayOffer(i),b.validateArrOfferAdded(FGSECOMAPP.cartItems),await b.checkEventCart([e],FGSECOMAPP.cartItems),localStorage.setItem(FGSECOMAPP.variables.constants.sca_offers_added,u.convertObjToString(FGSECOMAPP.arrOfferAdded)),FGSECOMAPP.variables.failedParseArrOffersAdded=!1,document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_FG_END))},reorderGiftProducts:e=>{let t=e.gift_products;e.type===A.OFFER_TYPE.function&&!e.is_offer_shipping&&(t=t?.map(c=>({...c,product_shopify_id:c.original_product_shopify_id,clone_product_handle:c.original_product_handle,variants:c.variants?.map(s=>({...s,product_shopify_id:s.original_product_shopify_id,variant_shopify_id:s.original_variant_shopify_id}))}))),t=v.handleTransformGiftsSliderData(t,e.is_offer_shipping?FGSECOMAPP.variables.Shopify.shipping_product_img:null);let i=e.gift_settings,{original_products_to_clone:r}=i;if(u.empty(r))return t;let o={};return r.forEach((c,s)=>{o[c?.product_shopify_id]=s}),t.map(c=>({...c,position:o[c.original_product_shopify_id]??0})).sort((c,s)=>c.position-s.position)},handleQuantityGiftAvailableSession:(e,t=0,i="",r=0)=>{try{let o=i?`_${i}`:"",c=`bogos_added_gift${o}`,s=`bogos_total_gift${o}`;if(e==="set"){let g=FGSECOMAPP.variables[c]??0,n=FGSECOMAPP.variables[s],d=i?r:FGSECOMAPP.offers.filter(a=>a.isReachConditions&&!a.is_offer_shipping).reduce((a,f)=>a+f.giftsAvailable,0);FGSECOMAPP.variables[c]=g+t,n||(FGSECOMAPP.variables[s]=d),FGSECOMAPP.variables[c]===FGSECOMAPP.variables[s]&&(FGSECOMAPP.variables[c]=void 0,FGSECOMAPP.variables[s]=void 0)}else Object.keys(FGSECOMAPP.variables).forEach(g=>{(g.startsWith("bogos_added_gift")||g.startsWith("bogos_total_gift"))&&(FGSECOMAPP.variables[g]=void 0)})}catch(o){console.log(o)}}},u={...at,checkCartItemIsGift:(e,t)=>{let i="-sca_clone_freegift",r=typeof e=="object",o=r&&(FGSECOMAPP.variables.giftIdsFunction.includes(e.variant_id)||FGSECOMAPP.variables.giftIds.includes(e.variant_id))&&e.properties?._bogos_trigger_type===A.OFFER_TYPE.gift_func&&!u.empty(e.properties?._bogos_trigger);return o&&!u.empty(t)?e.properties?._bogos_trigger_id===t.offer_root:!u.empty(e)&&(r&&(e.handle?.includes(i)||e.tags?.includes("bogos-gift")||FGSECOMAPP.variables.giftIds?.includes(e.variant_id)||o)||typeof e=="string"&&e.includes(i))},checkCartItemIsPurchaseOption:e=>{let{selling_plan_allocation:t}=e||{selling_plan_allocation:{selling_plan:null}};return!u.empty(t)&&!u.empty(t?.selling_plan)},convertProductEvent:(e,t)=>e?.map(i=>({id:i.product_shopify_id,title:u.renderOriginalProductTitle(i.original_product_shopify_id,i.title,i.product_shopify_id),handle:i.original_product_handle,thumbnail:i.thumbnail,belongs_to_offer:i.belongs_to_offer??`${t}`,variants:i.variants.map(r=>({id:r.variant_shopify_id,title:r.variant_title,price:r.price,original_price:r.cal_gift_price,thumbnail:r.thumbnail,discount_type:r.discount_type,discount_value:r.discount_value}))}))??[],aggregateArrOfferAddedIds:e=>{let t=[];return e.forEach(i=>{let{belongs_to_offer:r}=i;t.push(r.split("_")?.[0]??"")}),[...new Set(t.filter(i=>!u.empty(i)))]},renderGiftPrice:e=>{e??={};let t=FGSECOMAPP.variables.conditions.function,{show_cloned_price:i}=FGSECOMAPP.variables.Shopify??{},r=FGSECOMAPP.productsByID?.[e?.product_shopify_id]?.variants?.find(c=>c.id===e.variant_shopify_id),o=!t&&i?r?.price:void 0;return o?o/=L:o=e?.price,FGSECOMAPP.helper.formatter.format(o??0)},renderOriginalPrice:e=>{e??={};let t=FGSECOMAPP?.fgSettings?.cal_gift_discount==="compare_at_price"?"compare_at_price":"price",i=FGSECOMAPP.productsByID?.[e.original_product_shopify_id]?.variants?.find(o=>o.id===e.original_variant_shopify_id),r=i?.[t]??i?.price;return r?r/=L:r=e?.cal_gift_price,FGSECOMAPP.helper.formatter.format(r??0)},renderOriginalProductUrl:(e,t)=>{let i=FGSECOMAPP.productsByID[e]?.handle??t??"#";return u.routePath(`/products/${i}`)},renderOriginalProductTitle:(e,t,i)=>FGSECOMAPP.productsByID[e]?.title??(FGSECOMAPP.productsByID[i]?.title??t??"").replace("\xBB","").replace("\u{1F381}","").replace(/\(\d*(\.?\d*)% off\)/,"").replace("(Discount)",""),handleCountdownTimer:(e,t)=>{try{let i,r=()=>{let o=new Date,s=Date.parse(e)-o;if(s<0){clearInterval(i);return}let g=Math.floor(s/(1e3*60*60*24)),n=Math.floor(s/(1e3*60*60)),d=Math.floor(s/(1e3*60)),a=Math.floor(s/1e3),f=g,l=n-g*24,_=d-n*60,m=a-d*60,S=`.fg-gift-thumbnail-offer[data-fg-offer-id='${t}'] .fg-gift-thumbnail-offer-time-detail .fg-gift-thumbnail-time-element`;document.querySelectorAll(`${S}.day`).forEach(y=>{y.innerHTML=f.toString().padStart(2,"0")}),document.querySelectorAll(`${S}.hour`).forEach(y=>{y.innerHTML=l.toString().padStart(2,"0")}),document.querySelectorAll(`${S}.minutes`).forEach(y=>{y.innerHTML=_.toString().padStart(2,"0")}),document.querySelectorAll(`${S}.second`).forEach(y=>{y.innerHTML=m.toString().padStart(2,"0")})};i=setInterval(()=>{r()},1e3)}catch{}}},v={...ct,productsTemp:{},renderProductHTML:(e,t)=>{let i=t.belongs_to_offer?.some?.(h=>FGSECOMAPP.variables.gifts.offers_shipping.includes(h)),r=t?.variants[0]??{},{original_product_shopify_id:o,product_shopify_id:c,original_product_handle:s,belongs_to_offer:g}=t,n=u.checkIsDefaultTitle(r.variant_title),d=t.variants?.length,a=u.renderOriginalProductTitle(o,t.title,c),f=FGSECOMAPP.offers.find(h=>g===h?.id?.toString())?.giftsAvailable,{general:l}=FGSECOMAPP.fgAppearance?.gift_slider??{},_=l?.show_gift_for_customer==="by_variants",m=F.renderAppReviewEl(o),S=F.renderAppReviewEl?.(o,A.APP_REVIEW.trustoo),y=v.renderGiftQuantityOptions(f);return FGSECOMAPP.helper.templateHTML.render(e,{fg_product_handle:u.renderOriginalProductUrl(o,s),fg_product_img:u.handleResizeGiftImage(d===1?r.thumbnail:t.thumbnail),fg_offer_type:i?A.DISCOUNT_TYPE.shipping:A.OFFER_TYPE.cloned,fg_product_img_alt:a,fg_product_title:l?.show_product_title?a:"",fg_gifts_check_show_by_variants:_&&l?.show_variant_title&&!n?"":"sca-d-none",fg_gifts_check_show_by_products:_?"sca-d-none":"",fg_check_selected_variant:d===1?`active ${n?"sca-d-none":""}`:"",fg_variant_title:d!==1?F.convertIntegration(l?.select_gift_btn??"Select variant","customize.select_variant_button_text","customize.gift_slider.select_gift_btn"):r.variant_title,fg_original_price:u.renderOriginalPrice(r),fg_gift_price:u.renderGiftPrice(r),sca_fg_variant_select_section:v.renderVariantSelectOptions(t?.product_shopify_id,t.variants,t.thumbnail,g),fg_product_belongs_to_offer:t.belongs_to_offer,fg_variant_id:d===1?r.variant_shopify_id:"",fg_product_id:t?.product_shopify_id,offer:FGSECOMAPP.offers.find(h=>h.id===t.belongs_to_offer?.[0]),bogos_default_select_variant_title:F.convertIntegration(l?.select_gift_btn??"Select variant","customize.select_variant_button_text","customize.gift_slider.select_gift_btn"),bogos_check_show_select_variant:d===1?"sca-d-none":"",bogos_number_max_gifts:f??0,bogos_integration_judgeme:m,bogos_integration_trustoo:S,bogos_gift_quantity_options:y,bogos_check_show_quantity_box:FGSECOMAPP.fgSettings?.select_one_gift_price||!l?.enable_add_multiple_gifts?"sca-d-none":""})},renderGiftsOfferSection:(e,t,i={})=>{let{notify_gift_can_add:r}=FGSECOMAPP.fgAppearance?.gift_slider,o=document.querySelector(O.GIFT_OFFER_SECTION_ID)?.innerHTML??O.GIFT_OFFER_SECTION,c=(e??0)===0,s=c?F.convertIntegration(r?.number_gifts_can_be_added??"You can add {{number}} gift product(s)","customize.number_gifts_can_be_added_text","customize.gift_slider.number_gifts_can_be_added_text"):F.convertIntegration(r?.number_gifts_added??"You have added {{number}} gift product(s)","customize.number_gifts_added_text","customize.gift_slider.number_gifts_added_text");return FGSECOMAPP.helper.templateHTML.render(o,{sca_fg_disable_slider_section:v.HIDDEN_GIFT_POPUP(),check_show_number_gift_available:r?.enable===!1?"sca-d-none":"",check_show_number_gift_available_type:(e??0)===0?"warning":"success",bogos_number_gift_available:FGSECOMAPP.helper.templateHTML.render(s,{number:c?t:`${e}/${t}`}),...i})},renderTodayOffer:e=>{let{widget_info:t}=FGSECOMAPP.fgAppearance?.today_offer??{},i=document.querySelector("#sca-fg-today-offer-widget"),r=document.querySelector("#sca-fg-today-offer-iframe");if(e&&!FGSECOMAPP.offers?.length&&(i&&(i.innerHTML="",i.className=""),r&&(r.innerHTML="")),!t?.show_widget||!FGSECOMAPP.offers?.length||!i||!r)return;let o=document.querySelector(O.TODAY_OFFER_WIDGET_ID)?.innerHTML??O.TODAY_OFFER_WIDGET,c=document.querySelector(O.TODAY_OFFER_SECTION_ID)?.innerHTML??O.TODAY_OFFER_SECTION,s={};FGSECOMAPP.offers.forEach(d=>{s[d.offer_root]?s[d.offer_root].gift_products.push(...d.gift_products):s[d.offer_root]=JSON.parse(JSON.stringify(d))});let g=Object.values(s);g=g.sort((d,a)=>new Date(d.start_time)-new Date(a.start_time)),FGSECOMAPP.variables.todayOffers=g,i.innerHTML=FGSECOMAPP.helper.templateHTML.render(o),t?.widget_icon_style==="icon_and_title"&&(i.classList.add("sca-fg-today-offer-widget-with-title"),document.querySelector("#sca-fg-today-offer-widget .sca-fg-count-offers").style.right="-5px"),(t?.widget_icon_style==="icon"||!t?.widget_icon_style)&&(i.classList.remove("sca-fg-today-offer-widget-with-title"),document.querySelector("#sca-fg-today-offer-widget .sca-fg-title-icon-widget")?.classList?.add("sca-hide")),t?.widget_position==="bottom_left"&&(i.classList.add("sca-today-offer-widget-left"),r.classList.add("sca-today-offer-left")),t?.widget_position==="bottom_right"&&(i.classList.add("sca-today-offer-widget-right"),r.classList.add("sca-today-offer-right")),r.innerHTML=FGSECOMAPP.helper.templateHTML.render(c,{sca_fg_today_offer_footer:v.BRAND_MARK_TEMPLATE("today-offer-brand-mark")}),v.handleRenderTodayOfferBody(),document.querySelector("#sca-fg-today-offer-widget .sca-fg-count-offers").innerHTML=g.length.toString();let n=()=>{document.querySelector("#sca-fg-today-offer-iframe")?.classList.toggle("sca-show"),v.handleRenderTodayOfferBody(),document.querySelectorAll(".sca-fg-icon-success").forEach(f=>{f.classList.toggle("sca-hide")})};document.querySelector(".sca-fg-close-today-offer").addEventListener("click",n),!e&&document.querySelector("#sca-fg-today-offer-widget").addEventListener("click",n),v.handleCheckedTodayOffer(),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.RENDER_TODAY_OFFER,{detail:{todayOffers:g.map(d=>{let a=window.fgData.offers.find(f=>f.id.toString()===d.offer_root);return{id:`${a.id}`,title:F.convertIntegration(d.offer_name,`offer.offer_title_${d.offer_root}`,`offers.${d.offer_root}.offer_name`),gifts:u.convertProductEvent(a.gift_products,a.id),success:d.isReachConditions??!1}})}}))},handleRenderTodayOfferBody:(e=null)=>{let t=!u.empty(e),{widget_info:i}=FGSECOMAPP.fgAppearance?.today_offer??{},r=u.empty(i?.number_gift_show)?2:i?.number_gift_show,o=i?.gift_display==="by_variants",c=i?.show_gift_preview,s=[...FGSECOMAPP.variables.todayOffers];t&&(s=[FGSECOMAPP.variables.todayOffers.find(f=>f.offer_root?.toString()===e.toString())]);let g=document.querySelector(O.TODAY_OFFER_ITEM_SECTION_ID)?.innerHTML??O.TODAY_OFFER_ITEM_SECTION,n=document.querySelector(O.TODAY_OFFER_GIFT_PRODUCT_ID)?.innerHTML??O.TODAY_OFFER_GIFT_PRODUCT,d=document.querySelector(O.TODAY_OFFER_ITEM_HEADER_SECTION_ID)?.innerHTML??O.TODAY_OFFER_ITEM_HEADER_SECTION,a=document.querySelector(O.TODAY_OFFER_ITEM_HEADER_WITH_IMG_SECTION_ID)?.innerHTML??O.TODAY_OFFER_ITEM_HEADER_WITH_IMG_SECTION;document.querySelector("#sca-fg-today-offer-iframe .sca-fg-body .sca-fg-offers").innerHTML=s.map(f=>{let{offer_name:l,offer_root:_,gift_products:m,config:S,gift_settings:y,is_offer_shipping:h}=f,p=h&&y.shipping_discount.create_product,C=`${y.discount.type===A.DISCOUNT_TYPE.fixed_amount?u.renderPrice(u.convertMultiCurrency(y.discount.value)):y.discount.value+"%"}`,P=u.empty(S?.today_offer_title)?F.convertIntegration(l,`offer.offer_title_${_}`,`offers.${_}.offer_name`):F.convertIntegration(S?.today_offer_title,`offer.today_offer_${_}`,`offers.${_}.today_offer_title`),G=S?.offer_link??"",q=[...m];if(o){let T=[];for(let w of m)w?.variants?.forEach(N=>T.push({...w,thumbnail:N.thumbnail??w?.thumbnail,variants:[N]}));q=T}let R=q?.length,U=q.slice(0,r);return t&&(U=q),FGSECOMAPP.helper.templateHTML.render(g,{sca_fg_offer_id:_,sca_fg_offer_detail:t?"sca-fg-offer-detail":"",bogos_today_offer_header:FGSECOMAPP.helper.templateHTML.render(c?d:a,{sca_fg_offer_title:P,check_show_gift_notification:i?.show_gift_notification===!0?"":"sca-d-none",sca_fg_offer_subtitle:h?"":FGSECOMAPP.helper.templateHTML.render(F.convertIntegration(i?.gift_notification??"Get {{number}} gift for {{discountAmount}} OFF","customize.today_offer_gift_notification","customize.today_offer.gift_notification"),{number:y?.number_of_gift_can_receive,discountAmount:C}),bogos_offer_link_title:F.convertIntegration(i?.button_redirect_text??"Get offer","customize.today_offer_button_redirect_text","customize.today_offer.button_redirect_text"),sca_fg_offer_title_tooltip:P,bogos_today_offer_link:G,check_show_btn_redirect:u.empty(G)?"sca-d-none":"",sca_fg_offer_img:m[0].thumbnail}),check_show_gift_product:c?"":"sca-d-none",bogos_more_gift_product:!t&&R>r?FGSECOMAPP.helper.templateHTML.render(F.convertIntegration(i?.see_more_text??"See more ({{number}} products)","customize.today_offer_see_more_text","customize.today_offer.see_more_text"),{number:R-r}):"",check_show_more_product:(R>r||t)&&c?"":"sca-d-none",sca_bogos_offer_id:_,bogos_today_offer_gift_products:U.map(T=>{let w=T?.variants?.length>1,{original_product_shopify_id:N,title:V,product_shopify_id:D}=T??{};return FGSECOMAPP.helper.templateHTML.render(n,{bogos_today_offer_gift_img:T?.thumbnail??T?.variants[0]?.thumbnail,bogos_today_offer_gift_name:h&&!p?P:u.renderOriginalProductTitle(N,V,D),bogos_today_offer_gift_discount_price:h?null:u.renderGiftPrice(T?.variants[0]),bogos_today_offer_gift_original_price:h?"":u.renderOriginalPrice(T?.variants[0]),bogos_variants_selected:w?FGSECOMAPP.helper.templateHTML.render(F.convertIntegration(i?.variant_text??"{{number}} variants selected","customize.today_offer_variant_text","customize.today_offer.variant_text"),{number:T?.variants?.length}):"",check_show_selected_variant:w?"":"sca-d-none",check_show_variant_name:o&&!u.checkIsDefaultTitle(T.variants[0]?.variant_title)?"":"sca-d-none",bogos_today_offer_gift_variant_name:o?T.variants[0]?.variant_title:""})}).join(`
`),offer:f})}).join(`
`),v.handleCheckedTodayOffer(),v.renderTodayOfferQuerySelectorAll()},handleCheckedTodayOffer:()=>{let e=[...new Set(FGSECOMAPP.offers?.filter(t=>t.isReachConditions)?.map(t=>t.offer_root))];document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.TODAY_OFFER_CHANGE,{detail:{idOffersSuccess:e}})),document.querySelectorAll("#sca-fg-today-offer-iframe .sca-fg-offers .sca-fg-offer").forEach(t=>{e.includes(t.getAttribute("data-fg-offer-id"))?t.classList.add("sca-offer-archived"):t.classList.remove("sca-offer-archived")})},renderTodayOfferQuerySelectorAll:()=>{document.querySelectorAll(".sca-offer-title").forEach(function(e){e.addEventListener("mouseenter",function(t){let i=e.getAttribute("data-sca-fg-today-offer-title-tooltip");u.createTooltip(i,t.pageX+5,t.pageY+5)}),e.addEventListener("mouseleave",function(){u.removeTooltip()}),e.addEventListener("mousemove",u.moveTooltip)}),document.querySelectorAll("#sca-fg-today-offer-iframe .sca-offer-more-gift-products ").forEach(e=>{e.addEventListener("click",()=>{let t=e.getAttribute("data-bogos-offer-id");v.handleRenderTodayOfferBody(t),document.querySelector("#sca-fg-today-offer-iframe .sca-fg-body").scrollTo(0,0)})}),document.querySelectorAll("#sca-fg-today-offer-iframe .sca-fg-icon-back-offer-detail").forEach(e=>{e.addEventListener("click",()=>{v.handleRenderTodayOfferBody(),document.querySelectorAll(".sca-fg-icon-success").forEach(i=>{i.classList.toggle("sca-hide")})})})},handleTransformGiftsSliderData:(e,t)=>{let i=FGSECOMAPP.productsByID;return e.map(r=>{let o=i[r.product_shopify_id];return{...r,thumbnail:o?.featured_image??t??r.thumbnail,variants:r.variants.map(c=>{let s=o?.variants?.find(g=>g.id===c.variant_shopify_id);return{...c,thumbnail:s?.featured_image?.src??o?.featured_image??t??c.thumbnail??r.thumbnail}})}})},handleConvertGiftsBelongOffer:e=>{let t=e.map(r=>r.belongs_to_offer).flat().filter((r,o,c)=>c.indexOf(r)===o),i=FGSECOMAPP.offers.filter(r=>t.includes(r.offer_root)).reduce((r,o)=>({...r,[o.offer_root]:{...o,gift_items_filter:e.filter(c=>c.belongs_to_offer.includes(o.offer_root))}}),{});return Object.values(i)},filterOfferToGiftThumbnail:e=>{try{let t={},i={},r=FGSECOMAPP.offers;if(u.empty(e)){e=[];let s={},{current_product:g,other_products:n,current_collection:d}=FGSECOMAPP.variables.Shopify;u.empty(g)||(s[g.id]=g),[...n??[],...d?.products??[]].forEach(a=>s[a.id]=a),Object.values(FGSECOMAPP.productsInPage)?.filter(a=>!u.empty(a.info)&&(u.empty(a?.product_has_icon)||a?.product_has_icon&&!a?.positions?.every(f=>f?.classList?.contains("sca-gift-icon-collection-page"))))?.forEach(a=>{s[a.info.id]={...a.info}}),e=Object.values(s)}e?.forEach(s=>{let g=FGSECOMAPP.productsInPage[s.handle];FGSECOMAPP.productsInPage[s.handle]={...g,info:{...s},product_has_icon:u.empty(r)?void 0:!1};let n={handle:s.handle,tags:s.tags,variant_id:s.variants?.[0]?.id??-1};u.checkCartItemIsGift(n)&&g?.positions?.forEach(d=>d?.remove())});let o=FGSECOMAPP.fgSettings?.compare_gift_price_with_product,c=FGSECOMAPP.variables.Shopify?.enable_gift_icon_selected_product||FGSECOMAPP.fgAppearance.gift_icon?.enable_for_all_conditions;r?.forEach(s=>{let{offer_conditions:g}=s,{is_multiply:n,unit:d,product_narrow:a}=g?.[0]??{},f=g?.length===1&&d==="number_of_products"&&typeof n=="boolean"&&u.empty(a[0]?.track_pack_type);if(c&&(f=a?.length>0&&a[0]?.filter_option!=="exclude"),!f)return;let l;a?.forEach(_=>{switch(_.type){case A.NARROW_TYPE.product:l=Object.values(_.value);break;case A.NARROW_TYPE.product_types:let m=Object.keys(_.value);m.length>0&&(l=(l===void 0?e:l)?.filter(h=>m.includes(h.type))??[]);break;case A.NARROW_TYPE.product_vendors:let S=Object.keys(_.value);S.length>0&&(l=(l===void 0?e:l)?.filter(h=>S.includes(h.vendor))??[]);break;case A.NARROW_TYPE.collection:let y=Object.keys(_.value);y.length>0&&(l=(l===void 0?e:l)?.filter(h=>{let E=h.collections?.map(C=>C.id+"")?.filter(C=>y.includes(C));return!u.empty(E)})??[]);break;default:break}}),l?.forEach(_=>{let m=_.handle,S=JSON.parse(JSON.stringify(s.gift_products)),y=FGSECOMAPP.productsInPage[m]?.info??Object.values(FGSECOMAPP.productsInPage??{}).find(p=>p?.info?.id===_.id)?.info??{price_max:null};if(m=y.handle??m,FGSECOMAPP.fgSettings?.not_show_gift_if_already_on_cart&&(S=S.filter(p=>p.original_product_shopify_id!==y?.id)),o&&(S=S.filter(p=>p.variants.some(E=>E?.compare_gift_price<=y?.price_max/L)),u.empty(S)))return;if(t[m]){let p=t[m];S?.forEach(E=>{let C=p.find(G=>G.original_product_shopify_id===E.original_product_shopify_id);if(u.empty(C)){p.push({...E,belongs_to_offer:[s.offer_root]});return}let P=E.variants.map(G=>G.original_variant_shopify_id);!C.belongs_to_offer?.includes(s.offer_root)&&C.belongs_to_offer?.push(s.offer_root),C.variants=C?.variants?.filter(G=>!P.includes(G.original_variant_shopify_id))??[],C.variants=[...C.variants,...E.variants]}),t[m]=p}else t[m]=S?.map(p=>({...p,belongs_to_offer:[s.offer_root]}));let h=(_.variants??_.variant)?.map(p=>p.id)??[];u.empty(i[m])&&(i[m]={}),FGSECOMAPP.productsInPage[m]?.info?.variants?.filter(p=>h.includes(p.id))?.forEach(p=>{i[m][p.id]=i[m][p.id]??[];let E=S.filter(C=>{let P=C.variants;return o&&(P=P.filter(G=>G?.compare_gift_price<=p.price/L)),!u.empty(P)}).map(C=>({...C,belongs_to_offer:[s.offer_root]}));i[m][p.id].push(...E)})})});for(let s in t){let g=FGSECOMAPP.productsInPage[s];FGSECOMAPP.productsInPage[s]={...g,gifts_will_receive:[...t[s]],product_has_icon:!0,variants_has_gift:{...i[s]}}}return Object.entries(t)?.length?t:{}}catch(t){return console.warn("BOGOS track: Failed check products have customize",t),null}},renderElementGiftIconCollectionPage:()=>{let e=v.getProductHandleInPage(),t=v.filterOfferToGiftThumbnail();v.renderGiftIconForProducts(t),H.searchProducts(e,{"sca-product-search":"1"},!1,{handles:e}).then()},renderElementOldVersionGiftThumbnail:(e,t)=>{let i=document.querySelector(O.OLD_GIFT_THUMBNAIL_ITEMS_SECTION_ID)?.innerHTML??O.OLD_GIFT_THUMBNAIL_ITEMS_SECTION,r=e?.map(f=>v.renderProductHTML(i,f)).join(""),o=document.querySelector(O.OLD_GIFT_THUMBNAIL_SECTION_ID)?.innerHTML??O.OLD_GIFT_THUMBNAIL_SECTION,c=FGSECOMAPP.helper.templateHTML.render(o,{fg_check_show_narrow:e?.length>=4?"":"sca-d-none",sca_fg_gift_thumbnail_items_section:r}),{gift_thumbnail_query:s}=FGSECOMAPP.QUERY_SELECTOR??{},g=[...s?.tool,...s?.page_builder].filter(Boolean).join(","),n=[...s?.integration,...s?.default].filter(Boolean).join(","),d=!0,a=f=>{if(!f)return;let _=[...f.classList].some(p=>s?.page_builder?.toString()?.includes(p));_||(f.parentElement.style.width="100%",f.parentElement.style.height="auto",f.parentElement?.classList?.toggle("sca-fg-form-thumbnail-product-page",e.length>0));let m=f.parentNode.querySelector("#sca-gift-thumbnail");if(m)m.innerHTML=c;else{m=document.createElement("div"),m.setAttribute("id","sca-gift-thumbnail");let p=new DOMParser().parseFromString(c,"text/html");m.innerHTML=p.body.innerHTML,f.parentNode.insertBefore(m,f)}_?f.appendChild(m):f.parentNode.insertBefore(m,f);let S=m.querySelector("#fg-gift-thumbnail-title");if(S)switch(t.gift_thumbnail?.size){case"32":S.style.maxWidth="50%";break;case"50":S.style.maxWidth="60%";break;case"100":S.style.maxWidth="70%";break;case"160":S.style.maxWidth="80%";break;case"240":S.style.maxWidth="100%";break;default:S.style.maxWidth="60%"}let y=FGSECOMAPP.variables.Shopify?.number_gifts_thumbnail??4,h=m.querySelector(".sca-list-gift-thumbnail");e?.length>=y?new FGSECOMAPP.helper.Glider(h,{slidesToShow:Math.max(y-1,1),slidesToScroll:1,draggable:!0,dots:".dots-thumbnail",arrows:{prev:"#fg-gift-thumbnail-title .glider-prev",next:"#fg-gift-thumbnail-title .glider-next"}}):(S&&(S.style.maxWidth="100%"),h&&(h.style.display="flex")),d=!1};return document.querySelectorAll(g).forEach(a),d&&a(document.querySelector(n)),e},renderElementGiftThumbnail:(e,t)=>{let i=document.querySelector(O.GIFT_THUMBNAIL_SUB_ITEMS_SECTION_ID)?.innerHTML??O.GIFT_THUMBNAIL_SUB_ITEMS_SECTION,r=O.GIFT_THUMBNAIL_ITEMS_EXPIRED,{countdown_text:o,number_text:c,show_multiple:s,show_countdown_timer:g,show_number_gift:n}=t?.gift_thumbnail??{},d=document.querySelector(O.GIFT_THUMBNAIL_ITEMS_SECTION_ID)?.innerHTML??O.GIFT_THUMBNAIL_ITEMS_SECTION,a=e?.sort((p,E)=>p.priority-E.priority)?.map(p=>{let E=p?.gift_items_filter??[],C=E?.map(P=>FGSECOMAPP.helper.templateHTML.render(i,{fg_product_handle:u.renderOriginalProductUrl(P.original_product_shopify_id,P.original_product_handle),fg_offer_type:p.is_offer_shipping?A.DISCOUNT_TYPE.shipping:p.type,fg_product_img:u.handleResizeGiftImage(P.thumbnail),fg_product_img_alt:u.renderOriginalProductTitle(P.original_product_shopify_id,P.title)})).join(" ");return FGSECOMAPP.helper.templateHTML.render(d,{fg_offer_id:p.id,fg_offer_title:F.convertIntegration(p.offer_name,`offer.offer_title_${p.offer_root}`,`offers.${p.offer_root}.offer_name`),fg_offer_time_title:F.convertIntegration(o??"Expiring in","customize.gift_thumbnail_countdown_text","customize.gift_icon.gift_thumbnail_countdown_text"),fg_offer_time_detail:p.end_time?FGSECOMAPP.helper.templateHTML.render(r,{fg_time_day:"00",fg_time_hour:"00",fg_time_minutes:"00",fg_time_second:"00"}):"",fg_offer_body:C,fg_offer_footer_total:p.is_offer_shipping?"":`<span>${E.length}</span> ${F.convertIntegration(c??"gift items included","customize.gift_thumbnail_number_text","customize.gift_icon.gift_thumbnail_number_text")}`})}).join(" "),f=document.querySelector(O.GIFT_THUMBNAIL_SECTION_ID)?.innerHTML??O.GIFT_THUMBNAIL_SECTION,l=FGSECOMAPP.helper.templateHTML.render(f,{fg_gift_thumbnail_section:a}),{gift_thumbnail_query:_}=FGSECOMAPP.QUERY_SELECTOR??{},m=[..._?.tool,..._?.page_builder].filter(Boolean).join(","),S=[..._?.integration,..._?.default].filter(Boolean).join(","),y=!0,h=p=>{if(!p)return;let C=[...p.classList].some(T=>_?.page_builder?.toString()?.includes(T));C||(p.parentElement.style.width="100%",p.parentElement.style.height="auto",p.parentElement?.classList?.toggle("sca-fg-form-thumbnail-product-page",e.length>0));let P=p.parentNode.querySelector("#sca-gift-thumbnail");if(P)P.innerHTML=l;else{P=document.createElement("div"),P.setAttribute("id","sca-gift-thumbnail");let T=new DOMParser().parseFromString(l,"text/html");P.innerHTML=T.body.innerHTML,p.parentNode.insertBefore(P,p)}C?p.appendChild(P):p.parentNode.insertBefore(P,p);let G=s==="together",q=P.querySelector(".fg-gift-thumbnail-container");G?q?.classList.remove("seperated"):q?.classList.add("seperated");let R=g??!0,U=n??!0;P.querySelectorAll(".fg-gift-thumbnail-offer")?.forEach(T=>{let w=T.getAttribute("data-fg-offer-id"),N=e.find(tt=>tt.id===w),V=T.querySelectorAll(".fg-gift-thumbnail-offer-slider .product-item"),D=FGSECOMAPP.variables.Shopify?.number_gifts_thumbnail??4;V?.length>=D?new FGSECOMAPP.helper.Glider(T.querySelector(".glider"),{slidesToShow:D,slidesToScroll:1,arrows:{prev:`.fg-gift-thumbnail-offer[data-fg-offer-id="${w}"] .fg-gift-thumbnail-btn.glider-prev`,next:`.fg-gift-thumbnail-offer[data-fg-offer-id="${w}"] .fg-gift-thumbnail-btn.glider-next`}}):T.querySelector(".fg-gift-thumbnail-offer-footer .fg-gift-thumbnail-offer-footer-action").classList.add("sca-d-none"),V.length<=4?T.querySelector(".fg-gift-thumbnail-offer-slider").style.width="fit-content":T.querySelector(".fg-gift-thumbnail-offer-slider").style.width="unset";let x=T.querySelector(".fg-gift-thumbnail-offer-time");!N?.end_time||!R?x.classList.add("sca-d-none"):(x.classList.remove("sca-d-none"),u.handleCountdownTimer(N.end_time,w));let K=T.querySelector(".fg-gift-thumbnail-offer-footer"),X=T.querySelector(".fg-gift-thumbnail-offer-footer-quantity");U?(X.classList.remove("sca-d-none"),K.style.justifyContent="space-between"):(X.classList.add("sca-d-none"),K.style.justifyContent="flex-end")}),y=!1};return document.querySelectorAll(m).forEach(h),y&&h(document.querySelector(S)),e},renderElementGiftIconProductPage:()=>{let{product_page:e}=FGSECOMAPP.fgAppearance?.gift_icon??{},t=e?.gift_icon?.status,i=document.querySelector(O.GIFT_ICON_SECTION_ID)?.innerHTML??O.GIFT_ICON_SECTION,r=FGSECOMAPP.helper.templateHTML.render(i,{fg_class_product_or_collection_page:`sca-gift-icon-img ${t?"":"sca-d-none"}`}),{gift_icon_product_query:o}=FGSECOMAPP.QUERY_SELECTOR,c=[...o?.tool,...o?.page_builder].filter(Boolean).join(","),s=[...o?.default,...o?.integration].filter(Boolean).join(","),g=!0,n=d=>{if(!d)return;[...d.classList].some(_=>o?.page_builder?.toString()?.includes(_))||(d.style.position="relative",d.style.width="fit-content",d.classList?.toggle("sca-fg-form-icon-product-page",!0));let l=d.querySelector("#sca-gift-icon");l?l.innerHTML=r:(l=document.createElement("div"),l.setAttribute("id","sca-gift-icon"),l.innerHTML=r,d.appendChild(l)),!t&&(l.style.display="none"),g=!1};return document.querySelectorAll(c).forEach(n),g&&n(document.querySelector(s)),FGSECOMAPP.fgAppearance?.gift_icon?.gift_icon_path},renderGiftIconForProducts:(e,t)=>{let i=[],r=FGSECOMAPP.fgAppearance?.gift_icon?.collection_page?.status;Object.keys(e)?.forEach(o=>{let c=FGSECOMAPP.productsInPage[o],s=`href*='/${o}'`,g=c?.positions??(t?document.querySelectorAll(`.fg-secomapp-collection-img[${s}], .fg-secomapp-collection-img:has([${s}])`):[]);if(u.empty(g)||!Array.isArray(g))return;let n=document.querySelector(O.GIFT_ICON_SECTION_ID)?.innerHTML??O.GIFT_ICON_SECTION,d=FGSECOMAPP.helper.templateHTML.render(n,{fg_class_product_or_collection_page:`sca-gift-icon-collection-img ${r?"":"sca-d-none"}`}),a=[...new Set((c?.gifts_will_receive??[]).map(l=>l.belongs_to_offer).flat())],f=[];g.forEach(l=>{l.style.position="relative",l.classList?.toggle("sca-fg-icon-collection-page",!0);let _=l.querySelector(".sca-gift-icon-collection-page");if(_){let S=_.getAttribute("data-offer-ids")?.split(","),y=a.some(h=>!S?.includes?.(h));return _.setAttribute("data-offer-ids",a.join(",")),y&&f.push(l),!1}f.push(l),_=document.createElement("div"),_.setAttribute("class","sca-gift-icon-collection-page"),_.setAttribute("data-offer-ids",a.join(","));let m=new DOMParser().parseFromString(d,"text/html");_.innerHTML=m.body.innerHTML,!r&&(_.style.display="none"),l.appendChild(_)}),f.length&&i.push({positions:f,product:{...c?.info,handle:o},gifts:u.convertProductEvent(c?.gifts_will_receive??[]),belongs_to_offer:[...new Set(a)]})}),i.length&&document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.PRODUCT_HAS_GIFTS,{detail:{type:"product-list",icon:FGSECOMAPP.fgAppearance?.gift_icon?.gift_icon_path,products:i,enable:r}}))},fetchVariantsSelected:()=>{FGSECOMAPP.variables.Shopify?.enable_check_variants_has_gift&&document.addEventListener("change",function(){u.debounce(()=>{let e=new URL(document.URL),t=parseInt(e.searchParams.get("variant"));v.renderProductPage(t)},500)()})},renderBlockEmptyProductPage:()=>{let e=document.querySelector("#bogos-gift-icon-view-block-preview-mode");e&&v.renderEmpty(e,"There is the placeholder of gift icon.");let t=document.querySelector("#bogos-gift-thumbnail-view-block-preview-mode");t&&v.renderEmpty(t,"There is the placeholder of gift thumbnail.")},renderProductPage:e=>{let{enable_check_variants_has_gift:t,current_product:i}=FGSECOMAPP.variables.Shopify;if(u.empty(i))return;document.querySelector("#sca-gift-icon")?.remove(),document.querySelector("#sca-gift-thumbnail")?.remove();let r=v.filterOfferToGiftThumbnail(),o=location.pathname.split("/"),c=o?.indexOf("products"),s=decodeURI(c>=0?o[c+1]??null:null)??i?.handle,g=r?.[s];if(u.empty(g)){v.renderBlockEmptyProductPage();return}let n=FGSECOMAPP.productsInPage[s]?.variants_has_gift??{},d=Object.keys(n),a=!0;if(t&&(!u.empty(e)&&!d.includes(`${e}`)&&(a=!1),u.empty(e)&&!u.empty(i?.current_variant)&&!d.includes(i?.current_variant?.id?.toString())&&(a=!1),g=n[e??i?.current_variant?.id]??[]),a){let l=v.handleConvertGiftsBelongOffer(g),{product_page:_}=FGSECOMAPP.fgAppearance?.gift_icon??{},{use_old_version:m,status:S}=_?.gift_thumbnail??{};S&&(m??!0)?v.renderElementOldVersionGiftThumbnail(g,_):S&&v.renderElementGiftThumbnail(l,_),v.renderElementGiftIconProductPage(g)}let f=g?.map(l=>l.belongs_to_offer).flat();document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.PRODUCT_HAS_GIFTS,{detail:{type:"product",enable:FGSECOMAPP.fgAppearance?.gift_icon?.product_page?.gift_icon?.status,icon:FGSECOMAPP.fgAppearance?.gift_icon?.gift_icon_path,gifts:u.convertProductEvent(g),product:{handle:s,...i,variant:e??i?.current_variant?.id},belongs_to_offer:[...new Set(f)]}}))},renderCustomizeForProduct:async(e,t,i)=>{i??=await H.cacheProductsObj(e,t);let r=v.filterOfferToGiftThumbnail(i);return r?(t?.collection&&v.renderGiftIconForProducts(r,t?.isHeadless),t.product&&(FGSECOMAPP.variables.Shopify.current_product=i[0],v.renderProductPage()),Object.keys(r).map(o=>({[o]:FGSECOMAPP.productsInPage?.[o]}))):{}},fetchRoot:async(e,t={})=>{let i=document.querySelector("#bogos-gift-slider-view-block-preview-mode");if(e&&e.length>0){FGSECOMAPP.isDelayShowAdded&&(await new Promise(s=>setTimeout(s,1500)),FGSECOMAPP.isDelayShowAdded=!1);let r=FGSECOMAPP.fgAppearance?.gift_slider,o=r?.general?.use_old_version===!1;v.filterPageDisplay(r?.pages_display)&&(v.renderGiftSelectSection(Object.keys(t).length),o&&r?.general?.show_gift_type==="offer"?v.renderGiftSliderSeparateByOffer(t):v.renderGiftSliderViewByAllInOne(e),document.querySelectorAll("#freegifts-main-popup-container .glider-dots").forEach(s=>{s.children.length<=1&&(s.style.display="none")})),i&&(i.style.display="none !important")}else{let{gift_slider_query:r}=FGSECOMAPP.QUERY_SELECTOR??{},o=[...r?.page_builder,...r?.default].filter(Boolean).join(",");document.querySelectorAll(o).forEach(c=>c.innerHTML=""),i&&v.renderEmpty(i,"There is the placeholder of gift slider.")}e.length>0&&v.renderQuerySelectorAll(),FGSECOMAPP.fetchCheckoutEvents(),FGSECOMAPP.renderPromotionMessage(FGSECOMAPP.offers),b.arrSaveAllFetch=[]},renderQuerySelectorAll:()=>{let{type:e="variant"}=FGSECOMAPP.fgAppearance?.select_variant??{},t=document.querySelectorAll("[data-open]"),i=document.querySelectorAll("#freegifts-main-popup-container [data-close]"),r="sca-is-visible-fg",o=document.querySelectorAll("#fg-gift-items .btn-add-to-cart"),c=o.length;for(let a=0;a<c;a++)u.empty(o[a].getAttribute("data-variant"))&&(o[a].disabled=!0);for(let a of t)a.addEventListener("click",function(){let f=this.dataset.open;document.getElementById(f).classList.add(r)});for(let a of i)a.addEventListener("click",function(){b.handleQuantityGiftAvailableSession("remove"),this.parentElement.parentElement.classList.remove(r)});document.addEventListener("click",a=>{a.target===document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")&&(b.handleQuantityGiftAvailableSession("remove"),document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList.remove(r))}),document.addEventListener("click",a=>{(a.target??document.createElement("div")).closest(".bogos-slider-close-btn")&&(b.handleQuantityGiftAvailableSession("remove"),document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList.remove(r))}),document.addEventListener("keyup",a=>{a.key==="Escape"&&document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")&&(b.handleQuantityGiftAvailableSession("remove"),document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList.remove(r))});let{use_old_version:s,show_gift_type:g}=FGSECOMAPP.fgAppearance?.gift_slider?.general??{},n=s===!1,d=a=>{a.querySelector(".btn-add-to-cart").addEventListener("click",async function(){let l=this.getAttribute("data-variant")-0,_=this.getAttribute("data-offer"),m=FGSECOMAPP.offers.find(y=>y.id===_)?.giftsAvailable,S=1;if(n){let y=a.querySelector(".bogos-gift-item-quantity-input")??a.querySelector(".bogos-gift-quantity-input"),h=parseInt(y.value);S=isNaN(h)?1:Math.min(h,parseInt(m))}try{this.disabled=!0,this.classList.add("bogos-gift-adding"),this.innerHTML="",await b.addGiftToCart(l,S,_),this.disabled=!1,document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")&&(FGSECOMAPP.isDelayShowAdded=!0,await new Promise(h=>setTimeout(h,800))),window.location.href.includes("/cart")?location.reload():typeof Shopify?.getCart=="function"&&await Shopify?.getCart(FGSECOMAPP.variables.fgCallback?.[0])}catch(y){console.error("BOGOS track: error event click add-to-cart ",y)}FGSECOMAPP.variables.isHeadless&&document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_FG_PROCESS))})};document.querySelectorAll("#fg-gift-items .dropdown").forEach(a=>a.addEventListener("click",function(){this.setAttribute("tabindex",1),this.focus(),this.classList.toggle("active"),this.querySelector(".dropdown-menu").classList.toggle("d-block")})),document.querySelectorAll("#fg-gift-items .dropdown").forEach(a=>document.addEventListener("click",function(f){a.contains(f.target)||(a.classList.remove("active"),a.querySelector(".dropdown-menu").classList.remove("d-block")),document.querySelectorAll(".btn-add-to-cart.sca-fg-out-stock").forEach(_=>{_.disabled=!0})})),document.querySelectorAll("#fg-gift-items .product-item").forEach(a=>{a.querySelectorAll(".dropdown > .dropdown-menu > li").forEach(f=>{f.addEventListener("click",function(){let l=this.getAttribute("id"),_=this.getAttribute("data-img"),m=this.getAttribute("data-price"),S=this.getAttribute("data-original-price"),y=this.getAttribute("data-original-id"),h=a.querySelector(".top-content");h.querySelector(".product-item-thumbnail").setAttribute("src",_);let p=new URL(h.querySelector(".gift-original-url").href);p.searchParams.set("variant",y),h.querySelector(".gift-original-url").href=p.toString();let E=a.querySelector(".bottom-content");E.querySelector(".original-price del").textContent=S,E.querySelector(".gift-price").textContent=m;let C=E?.querySelector(".btn-add-to-cart");C.setAttribute("data-variant",l),C.disabled=!1,C.style="";let P=E.querySelector(".selected-variant");P.classList.add("active"),P.innerHTML=this.innerText})}),d(a)}),document.querySelectorAll(".bogos-gifts-slider-container .bogos-offer-gift-item").forEach(a=>{a.querySelectorAll(".bogos-gift-select-variant-wrapper:has(.bogos-gift-select-variant-option)").forEach(l=>{let _=l.querySelector(".bogos-gift-select-variant-dropdown"),m=l.querySelectorAll(".bogos-gift-select-variant-option"),S=a.querySelector(".bogos-gift-item-bottom-info"),y=a.querySelector(".bogos-gift-select-variant-title"),h=S?.querySelector(".btn-add-to-cart"),p=()=>{_.classList.toggle("opened")},E=P=>{let G=P.currentTarget.getAttribute("data-variant-id")-0,q=P.currentTarget.getAttribute("data-img"),R=P.currentTarget.getAttribute("data-price"),U=P.currentTarget.getAttribute("data-original-price"),T=P.currentTarget.getAttribute("data-original-id");y.textContent=P.currentTarget.textContent.trim();let w=a.querySelector(".bogos-gift-item-image-container");w.querySelector(".bogos-gift-item-image").setAttribute("src",q);let N=new URL(w.querySelector(".gift-original-url").href);N.searchParams.set("variant",T),w.querySelector(".gift-original-url").href=N.toString(),S.querySelector(".bogos-gift-item-compare-price").textContent=U,S.querySelector(".bogos-gift-item-price").textContent=R,h.setAttribute("data-variant",G),h.disabled=!1,h.style=""},C=P=>{!l.contains(P.target)&&_.classList.contains("opened")&&_.classList.remove("opened")};document.addEventListener("click",C),m.forEach(P=>{P.addEventListener("click",E)}),_.addEventListener("click",p)}),a.querySelectorAll(".bogos-gift-select-variant-wrapper:not(:has(.bogos-gift-select-variant-option))").forEach(l=>{let _=l.querySelector(".bogos-gift-select-variant-dropdown"),m=a.querySelector(".bogos-gift-item-bottom-info"),S=a.querySelector(".bogos-gift-select-variant-title"),y=m?.querySelector(".btn-add-to-cart"),h=async()=>{if(_.classList.toggle("opened"),e==="option"&&!_.querySelector(".bogos-select-option-name-container")){let E=y.getAttribute("data-product"),C=y.getAttribute("data-offer"),P=_.querySelector(".bogos-gift-select-variant-options");if(!FGSECOMAPP.productsDefaultByID[E]){let R=await W.queryProductDefault(E);if(u.empty(R))return}let G=v.productsTemp[C][E]??{},q=v.convertProductWithOptionsDefault(FGSECOMAPP.productsDefaultByID[E],G);P.innerHTML=v.renderProductOptionWithValue(q)}};l.addEventListener("click",E=>{let C=E.target??document.createElement("div");if(C.closest(".bogos-select-option-custom-item")){let P=C.closest(".bogos-select-option-custom-item"),G=decodeURIComponent(P.getAttribute("data-option-value")),q=y.getAttribute("data-product"),R=y.getAttribute("data-variant"),U=y.getAttribute("data-offer"),T=v.productsTemp[U][q]??{},N=(T?.variants?.find(I=>I.id?.toString()===R)??T?.variants[0])?.options??[],V=T?.options.findIndex(I=>P.getAttribute("data-option-name")===I),D=N?.map((I,$)=>V===$?G:I),Y=T?.variants?.find(I=>I.options.length===D.length&&I.options.every(($,j)=>$===D[j]));if(!Y&&!R&&(Y=T.variants?.find(I=>I.options?.[V]===G),D=Y?.options??D),l.querySelectorAll(".bogos-select-option-custom-item").forEach(I=>{let $=decodeURIComponent(I.getAttribute("data-option-value"));D.includes($)?I.classList.add("bogos-active"):I.classList.remove("bogos-active"),I.classList.remove("bogos-deactivate")}),!Y){y.disabled=!0;let I=[...T.variants],$=[];D.forEach((j,z)=>{I.some(Q=>Q.options[z]===j)?I=I.filter(Q=>Q.options[z]===j):$.push({position:z,value:j})}),l.querySelectorAll(".bogos-select-option-name-container").forEach((j,z)=>{j.querySelectorAll(".bogos-select-option-custom-item").forEach(Z=>{let Q=decodeURIComponent(Z.getAttribute("data-option-value"));$.some(rt=>rt.position===z&&rt.value===Q)?Z.classList.add("bogos-deactivate"):Z.classList.remove("bogos-deactivate")})});return}let x=FGSECOMAPP.variables.giftItemsChoose[Y.id],K=x.variant_shopify_id,X=u.handleResizeGiftImage(x.thumbnail??x.product_img),tt=u.renderGiftPrice(x),dt=u.renderOriginalPrice(x),ft=x.original_variant_shopify_id;S.textContent=x.variant_title.trim();let et=a.querySelector(".bogos-gift-item-image-container");et.querySelector(".bogos-gift-item-image").setAttribute("src",X);let ot=new URL(et.querySelector(".gift-original-url").href);ot.searchParams.set("variant",ft),et.querySelector(".gift-original-url").href=ot.toString(),m.querySelector(".bogos-gift-item-compare-price").textContent=dt,m.querySelector(".bogos-gift-item-price").textContent=tt,y.setAttribute("data-variant",K),y.disabled=!1,y.style=""}});let p=E=>{!l.contains(E.target)&&_.classList.contains("opened")&&_.classList.remove("opened")};document.addEventListener("click",p),_.querySelector(".bogos-gift-select-variant-title").addEventListener("click",h)}),d(a);let f=a.querySelector(".bogos-gift-select-variant");f&&f.addEventListener("change",function(){let l=a.querySelector(".bogos-gift-item-bottom-info"),_=l?.querySelector(".btn-add-to-cart");if(u.empty(this.value)){_.disabled=!0,_.setAttribute("data-variant","");return}let m=this.value-0,S=f.querySelector(`[value="${m}"]`);if(S){let y=S.getAttribute("data-img"),h=S.getAttribute("data-price"),p=S.getAttribute("data-original-price"),E=S.getAttribute("data-original-id"),C=a.querySelector(".bogos-gift-item-image-container");C.querySelector(".bogos-gift-item-image").setAttribute("src",y);let P=new URL(C.querySelector(".gift-original-url").href);P.searchParams.set("variant",E),C.querySelector(".gift-original-url").href=P.toString(),l.querySelector(".bogos-gift-item-compare-price").textContent=p,l.querySelector(".bogos-gift-item-price").textContent=h,_.setAttribute("data-variant",m),_.disabled=!1,_.style=""}})}),document.querySelectorAll(".bogos-gifts-slider-container .bogos-gift-item-quantity-wrapper").forEach(a=>{let f=a.querySelector(".bogos-gift-item-quantity-dropdown"),l=a.querySelector(".bogos-gift-item-quantity-input"),_=a.querySelectorAll(".bogos-gift-item-quantity-option"),m=()=>{f.classList.toggle("opened")},S=h=>{l.value=h.currentTarget.getAttribute("data-quantity")},y=h=>{!a.contains(h.target)&&f.classList.contains("opened")&&f.classList.remove("opened")};document.addEventListener("click",y),_.forEach(h=>{h.addEventListener("click",S)}),f.addEventListener("click",m)}),document.querySelectorAll(".freegifts-main-container .bogos-slider-offer").forEach(a=>{let f=a.querySelector("#sca-hidden-gift-popup .sca-disable-checkbox");f?.addEventListener("change",async()=>{if(f.checked)if(n&&g==="offer"){let l=a.getAttribute("data-offer");l&&(localStorage.setItem(`FGSECOMAPP_HIDDEN_GIFT_OFFER_${l}`,`${Date.now()}`),await new Promise(_=>setTimeout(_,400)),a.classList.add("sca-d-none"),document.querySelectorAll(".bogos-slider-offers-container .bogos-slider-offer:not(.sca-d-none)").length||(document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList?.remove(r),document.querySelector("#freegifts-main-page-container:not(.sca-modal-fg)")?.classList?.add("sca-d-none")))}else localStorage.setItem("FGSECOMAPP_HIDDEN_GIFT_POPUP",`${Date.now()}`),await new Promise(l=>setTimeout(l,400)),document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList?.remove(r),document.querySelector("#freegifts-main-page-container:not(.sca-modal-fg)")?.classList?.add("sca-d-none")})}),document.querySelectorAll(".freegifts-main-container .slide-container.sca-modal-dialog-fg").forEach(a=>{let f=a.querySelector("#sca-hidden-gift-popup .sca-disable-checkbox");f?.addEventListener("change",async()=>{f.checked&&(localStorage.setItem("FGSECOMAPP_HIDDEN_GIFT_POPUP",`${Date.now()}`),await new Promise(l=>setTimeout(l,400)),document.querySelector("#freegifts-main-popup-container.sca-modal-fg.sca-is-visible-fg")?.classList?.remove(r),document.querySelector("#freegifts-main-page-container:not(.sca-modal-fg)")?.classList?.add("sca-d-none"))})})},renderGiftsIntoPerSlider:(e,t,i,r)=>{e.innerHTML=t.map(o=>v.renderProductHTML(i,o)).join(`
`),e.setAttribute("data-show-desktop",`${r}`),v.renderGlider(e,r)},renderGlider:(e,t)=>{let{bogos_settings_glider:i}=FGSECOMAPP.variables.Shopify,{general:r}=FGSECOMAPP.fgAppearance?.gift_slider,o=r?.number_product_slider_mobile??1.8,c=e.parentElement.parentElement;e.setAttribute("data-show-mobile",`${o}`),new FGSECOMAPP.helper.Glider(e,{slidesToShow:1,slidesToScroll:1,draggable:!1,dots:r?.show_pagination?c?.querySelector(".dots"):null,arrows:{prev:c?.querySelector(".glider-prev"),next:c?.querySelector(".glider-next")},responsive:[{breakpoint:750,settings:{slidesToShow:t??4,slidesToScroll:t??4}},{breakpoint:300,settings:{slidesToShow:o===1?o:o+.04,slidesToScroll:o}}],...typeof i=="object"?i:{}}).refresh()},renderGiftSliderSeparateByOffer:e=>{let t=[];Object.entries(e).forEach(([d,a])=>{let f=[...a];if(FGSECOMAPP.fgAppearance?.gift_slider?.general?.show_gift_for_customer==="by_variants"){f=[];for(let m of a){let{variants:S}=m??{};S?.forEach(y=>f.push({...m,thumbnail:y.thumbnail,variants:[y]}))}}let l=FGSECOMAPP.offers.filter(m=>m.offer_root===d.toString()),_=l[0]??{};t.push({offer_name:_.offer_name,offer_root:d,priority:_.priority,giftsAvailable:l.reduce((m,S)=>m+S.giftsAvailable,0),arrGiftShow:f})}),t=t?.sort((d,a)=>d.priority-a.priority);let i=Math.max(...t.map(d=>d?.arrGiftShow?.length)),{general:r}=FGSECOMAPP.fgAppearance?.gift_slider,o=r?.number_product_slider??4,c=o,s=document.querySelector(O.GIFT_ITEM_SECTION_V2_ID)?.innerHTML??O.GIFT_ITEM_SECTION_V2;document.querySelectorAll(".bogos-gifts-slider-container .bogos-slider-offers-container").forEach(d=>{d.innerHTML=t.map(a=>{b.handleQuantityGiftAvailableSession("set",0,a.offer_root,a.giftsAvailable);let f=FGSECOMAPP.variables[`bogos_added_gift_${a.offer_root}`],l=FGSECOMAPP.variables[`bogos_total_gift_${a.offer_root}`];return v.renderGiftsOfferSection(f,l,{bogos_check_show_quantity_box:FGSECOMAPP.fgSettings?.select_one_gift_price?"sca-d-none":"",bogos_offer_id:a?.offer_root?.toString(),bogos_offer_title:F.convertIntegration(a.offer_name,`offer.offer_title_${a.offer_root}`,`offers.${a.offer_root}.offer_name`)})}).join(`
`)}),document.querySelectorAll(".bogos-gifts-slider-container .bogos-slider-offer-switch-show").forEach(d=>{(i<=2||o<=2)&&(d.style.position="unset")});let n=document.querySelector(".bogos-gifts-slider-container.bogos-gift-slider-modal");if((i<=o||o<=4)&&n){let d=Math.min(i,o);n.style.setProperty("max-width",Math.min(d,4)*(i===1?350:163)+12*d+50+"px","important"),c=d}document.querySelectorAll(".bogos-gifts-slider-container .bogos-slider-offers-container").forEach(d=>{d.querySelectorAll(".bogos-offer-gift-items-container").forEach((a,f)=>{v.renderGiftsIntoPerSlider(a,t[f].arrGiftShow,s,c)})}),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.SHOW_GIFT_SLIDER,{detail:{addGiftToCartFunc:FGSECOMAPP.helper.addGiftToCart,giftsOffer:t}}))},renderGiftSliderViewByAllInOne:e=>{let t=[...e];if(FGSECOMAPP.fgAppearance?.gift_slider?.general?.show_gift_for_customer==="by_variants"){t=[];for(let a of e)a.variants?.forEach(f=>t.push({...a,thumbnail:f.thumbnail,variants:[f]}))}let i=t.length,{general:r}=FGSECOMAPP.fgAppearance?.gift_slider,o=r?.use_old_version===!1,c=r?.number_product_slider??4,s=c,g=o?document.querySelector(".bogos-gifts-slider-container.bogos-gift-slider-modal"):document.querySelector(".slide-container.sca-modal-dialog-fg"),n=o?".bogos-offer-gift-items-container":".bogos-gift-items",d=o?document.querySelector(O.GIFT_ITEM_SECTION_V2_ID)?.innerHTML??O.GIFT_ITEM_SECTION_V2:document.querySelector(O.GIFT_ITEM_SECTION_ID)?.innerHTML??O.GIFT_ITEM_SECTION;if(o){b.handleQuantityGiftAvailableSession("set");let a=FGSECOMAPP.variables.bogos_added_gift,f=FGSECOMAPP.variables.bogos_total_gift;document.querySelectorAll(".bogos-gifts-slider-container .bogos-slider-offers-container").forEach(l=>{l.innerHTML=v.renderGiftsOfferSection(a,f,{bogos_check_offer_title:"sca-d-none"})}),document.querySelectorAll(".bogos-gifts-slider-container .bogos-slider-offer-switch-show").forEach(l=>{l&&(i<=2||c<=2)&&(l.style.position="unset")})}if((i<=c||c<=4)&&g){let a=Math.min(i,c);g.style.setProperty("max-width",Math.min(a,4)*(i===1?350:163)+12*a+50+"px","important"),s=a}document.querySelectorAll(n).forEach(a=>{v.renderGiftsIntoPerSlider(a,t,d,s)}),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.SHOW_GIFT_SLIDER,{detail:{addGiftToCartFunc:FGSECOMAPP.helper.addGiftToCart,gifts:u.convertProductEvent(t)}}))},renderGiftSelectSection:e=>{let t=FGSECOMAPP.fgAppearance?.gift_slider??{},i=F.convertIntegration(t?.notify_offer_available?.text??"\u{1F381} You have qualified for {{qualifiedOffers}} offer(s)!","customize.notify_offer_available_text","customize.gift_slider.notify_offer_available_text"),r=t?.general?.use_old_version===!1,{gift_slider_query:o}=FGSECOMAPP.QUERY_SELECTOR??{},c=[...o?.page_builder,...o?.default,...o?.tool??[]].filter(Boolean).join(","),s=u.getDataConfigSetting("sca_fg_gift_slider_position"),g={after:"afterend",before:"beforebegin",in:"beforeend"};u.prepareShadowRootEl?.("gift_slider_query",{slot:"bogos-gift-slider-view",keyEl:".bogos-gift-slider-view",position:g[s]??"beforebegin",addNonRoot:!0});let n=document.querySelectorAll(c);if(n?.length>0){let f=r?document.querySelector(O.GIFTS_CART_SECTION_V2_ID)?.innerHTML??O.GIFTS_CART_SECTION_V2:document.querySelector(O.GIFTS_CART_SECTION_ID)?.innerHTML??O.GIFTS_CART_SECTION;n.forEach(l=>{l.classList?.toggle("freegifts-main-container",!0),l.innerHTML=FGSECOMAPP.helper.templateHTML.render(f,{sca_fg_disable_slider_section:`${v.BRAND_MARK_TEMPLATE()}`,bogos_check_show_offer_available:r&&t?.notify_offer_available?.enable&&t?.general?.show_gift_type==="offer"?"":"sca-d-none",bogos_slider_offer_available:FGSECOMAPP.helper.templateHTML.render(i,{qualifiedOffers:e,totalOffers:FGSECOMAPP.offers.length}),bogos_brand_mark:v.BRAND_MARK_TEMPLATE("bogos-brand-mark-gift-slider-v2")})});return}let{FGSECOMAPP_HIDDEN_GIFT_POPUP:d}=FGSECOMAPP.variables.constants;if(v.handleCheckHiddenGiftSlider(d)||(n=document.querySelector(o.popup.filter(Boolean).join(",")),!n))return;let a=r?document.querySelector(O.GIFTS_POPUP_SECTION_V2_ID)?.innerHTML??O.GIFTS_POPUP_SECTION_V2:document.querySelector(O.GIFTS_POPUP_SECTION_ID)?.innerHTML??O.GIFTS_POPUP_SECTION;n.innerHTML=FGSECOMAPP.helper.templateHTML.render(a,{sca_fg_disable_slider_section:`${v.HIDDEN_GIFT_POPUP()} ${v.BRAND_MARK_TEMPLATE()}`,bogos_check_show_offer_available:r&&t?.notify_offer_available?.enable&&t?.general?.show_gift_type==="offer"?"":"sca-d-none",bogos_slider_offer_available:FGSECOMAPP.helper.templateHTML.render(i,{qualifiedOffers:e,totalOffers:FGSECOMAPP.offers.length}),bogos_brand_mark:v.BRAND_MARK_TEMPLATE("bogos-brand-mark-gift-slider-v2")}),n.classList.add("sca-is-visible-fg")},convertProductWithOptions:(e,t)=>{let i={...e,variants:t.map(r=>e?.variants?.find(o=>String(o.id)===String(r.variant_shopify_id))).filter(Boolean)};return{...i,optionsConverted:(i?.options??[]).map((r,o)=>{let c=[...new Set(i?.variants?.map(s=>s?.options?.[o]))];return{name:r,values:c}})}},convertProductWithOptionsDefault:(e,t)=>{let i={...t,optionsDefault:e?.options??[],variants:t.variants.map(r=>{let o=e?.variants?.find(c=>String(c.id)===String(r.id));return{...r,optionsDefault:o?.options??[]}})};return{...i,optionsConvertedDefault:(i?.optionsDefault??[]).map((r,o)=>{let c=[...new Set(i?.variants?.map(s=>s?.optionsDefault?.[o]))];return{name:r,values:c}})}},renderProductOptionWithValue:e=>{let{configs:t=[]}=FGSECOMAPP.fgAppearance?.select_variant??{},i=O.SELECT_PRODUCT_OPTION_NAME_CONTAINER_SECTION,r=O.SELECT_PRODUCT_OPTION_ITEM_CUSTOM_SECTION,o=O.SELECT_PRODUCT_OPTION_ITEM_WITH_COLOR_CUSTOM_SECTION,c=O.SELECT_PRODUCT_OPTION_ITEM_WITH_IMAGE_CUSTOM_SECTION,s={small:"12px",medium:"20px",large:"32px"},g=e.variants[0]?.options,n=e?.optionsConverted??[],d=e?.optionsConvertedDefault??[];return n.map((a,f)=>{let l=t.find(y=>y.data?.option_name===d[f]?.name),_=l?.type==="color",m=l?_?o:c:r,S=a.values?.map((y,h)=>{if(l){let p=l.customize,E=l?.data?.values?.find(C=>C.name===d[f]?.values?.[h])?.label??(_?"#ffffff":"https://d33a6lvgbd0fej.cloudfront.net/bogos-images/1760928468.png");return FGSECOMAPP.helper.templateHTML.render(m,{bogos_option_value:encodeURIComponent(y),bogos_option_value_title:y,bogos_option_custom_data:E,bogos_option_name:a.name,bogos_option_color_style:`background-color: ${E}; width: ${s[p.size]};
                                     height: ${s[p.size]}; border-radius: ${p.shape==="circle"?"50%":"4px"}`,bogos_option_color_container_style:`border-radius: ${p.shape==="circle"&&!p.show_name?"50%":"4px"}`,check_show_title:p.show_name?"":"sca-d-none",check_activate:g?.includes(y)?"bogos-active":"",bogos_option_image_style:`width: ${s[p.size]}; height: ${s[p.size]}; border-radius: ${p.shape==="circle"?"50%":"4px"}`})}else return FGSECOMAPP.helper.templateHTML.render(m,{bogos_option_value:encodeURIComponent(y),bogos_option_value_title:y,bogos_option_name:a.name,check_activate:g?.includes(y)?"bogos-active":""})}).join("");return FGSECOMAPP.helper.templateHTML.render(i,{bogos_option_name:a.name,bogos_option_items:S})}).join("")},renderVariantSelectOptions:(e,t,i,r)=>{let o=FGSECOMAPP.productsByID[e];FGSECOMAPP.variables.giftItemsChoose={...FGSECOMAPP.variables.giftItemsChoose??{}},t.forEach(s=>{FGSECOMAPP.variables.giftItemsChoose[s.variant_shopify_id]={...s,product_img:i}});let{type:c="variant"}=FGSECOMAPP.fgAppearance?.select_variant??{};if(c==="variant"){let g=FGSECOMAPP.fgAppearance?.gift_slider?.general?.use_old_version===!1?document.querySelector(O.GIFT_SELECT_SECTION_V2_ID)?.innerHTML??O.GIFT_SELECT_SECTION_V2:document.querySelector(O.GIFT_SELECT_SECTION_ID)?.innerHTML??O.GIFT_SELECT_SECTION;return t.map(n=>FGSECOMAPP.helper.templateHTML.render(g,{fg_variant_img:u.handleResizeGiftImage(n.thumbnail??i),fg_variant_id:n.variant_shopify_id,fg_original_variant_id:n.original_variant_shopify_id,fg_variant_price:u.renderGiftPrice(n),fg_original_variant_price:u.renderOriginalPrice(n),fg_variant_title:o?.variants?.find(d=>String(d.id)===String(n.variant_shopify_id))?.title??n.variant_title,variant:n})).join(`
`)}else{let s=v.convertProductWithOptions(o,t);return v.productsTemp[r]={...v.productsTemp[r]??{}},v.productsTemp[r][s.id]=s,W.queryProductDefault(s.id).then(),'<div class="bogos-loading-spinner"></div>'}},renderGiftQuantityOptions:e=>{let t='<li class="bogos-gift-item-quantity-option" data-quantity="{{bogos_gift_quantity}}">{{ bogos_gift_quantity }}</li>';return Array.from({length:e},(i,r)=>r+1).map(i=>FGSECOMAPP.helper.templateHTML.render(t,{bogos_gift_quantity:i})).join(`
`)},renderPromotionMessage:e=>{try{if(!FGSECOMAPP.fgAppearance?.promotion_message?.show_on_cart_page)return;let{enable_hidden_message_added:t}=FGSECOMAPP.variables.Shopify??{};u.empty(e)&&(e=[...FGSECOMAPP.offers]);let i=location.href.includes("/cart"),r=[];if(e?.forEach(_=>{if(_.isReachConditions&&(!t||_.giftsAdded?.length)||u.empty(_.promotion_message)||!u.empty(FGSECOMAPP.variables.maxOfferPriority)&&!_.isReachConditions&&_.priority>FGSECOMAPP.variables.maxOfferPriority||u.empty((_.count_down_value??0)+(_.count_down_quantity??0))&&/({{\s*sca_min_total\s*}})|({{\s*sca_min_quantity\s*}})/gm.test(_.promotion_message))return;let m=_.count_down_value?.toFixed(FGSECOMAPP.variables.Shopify?.sca_amount_fixed??2);r.push({value:FGSECOMAPP.helper.templateHTML.render(F.convertIntegration(_.promotion_message,`offer.cart_message_${_.offer_root}`,`offers.${_.offer_root}.promotion_message`),{sca_min_total_with_currency:u.renderPrice(m),sca_min_total:m,sca_min_quantity:_.count_down_quantity}),offer:_})}),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.RENDER_CART_MESSAGE,{detail:{data:r.map(_=>({offer:_.value,offer_root:_.offer?.offer_root}))}})),u.empty(r)){document.querySelectorAll(".sca-promotion-message-layout").forEach(m=>m.innerHTML="");let _=document.querySelector("#bogos-cart-message-view-block-preview-mode");_&&v.renderEmpty(_,"There is the placeholder of cart message.");return}let o=document.querySelector(O.CART_MSG_ITEM_SECTION_ID)?.innerHTML??O.CART_MSG_ITEM_SECTION,c=r.map(_=>FGSECOMAPP.helper.templateHTML.render(o,{fg_cart_message:_.value,offer:_.offer})).join(""),s=document.querySelector(O.CART_MSG_SECTION_ID)?.innerHTML??O.CART_MSG_SECTION,g=FGSECOMAPP.helper.templateHTML.render(s,{sca_fg_cart_message_items_section:c}),{cart_message_query:n}=FGSECOMAPP.QUERY_SELECTOR,d=document.querySelector([...n?.default].filter(Boolean).join(",")),a=[...document.querySelectorAll([...n?.tool,...n?.integration,...n?.page_builder].filter(Boolean).join(",")),...u.prepareShadowRootEl?.("cart_message_query",{slot:"bogos-cart-message-view",keyEl:".bogos-cart-message-view",position:"beforebegin"})??[]];document.querySelectorAll(".sca-promotion-message-layout").forEach(_=>_.innerHTML=g);let f=document.createElement("div");f.setAttribute("id","sca-promotion-message-layout"),f.classList.add("sca-promotion-message-layout");let l=new DOMParser().parseFromString(g,"text/html");f.innerHTML=l.body.innerHTML,u.empty(a)||a?.forEach(_=>{if(_.querySelector(".sca-promotion-message-layout"))return;let m=f.cloneNode(!0);_.prepend(m)}),d?.querySelector(".sca-promotion-message-layout")||(l=new DOMParser().parseFromString(g,"text/html"),f.innerHTML=l.body.innerHTML,d&&i&&d.prepend(f)),document.querySelectorAll(".sca-promotion-glider").forEach(_=>{let m=new FGSECOMAPP.helper.Glider(_)||{ele:null,scrollItem:()=>{}};((y,h)=>{let p=y.track.childElementCount,E=null,C=1;function P(){E=setTimeout(()=>{C>=p&&(C=0),y.scrollItem(C++)},h)}y.ele?.addEventListener("glider-animated",function(){window.clearInterval(E),P()}),P()})(m,FGSECOMAPP.variables.Shopify?.sca_deplay_cart_msg??3e3)})}catch(t){console.warn("BOGOS track: Failed render cart message",t)}},renderSuccessAddGift:()=>{if(!FGSECOMAPP.variables.Shopify?.enable_toast_added)return;let e=document.querySelector(".sca-fg-notifications");if(!e)return;e.innerHTML="";let t=FGSECOMAPP.variables.Shopify?.sca_text_notify_success??"Add gift to cart successfully!",i=document.createElement("div");i.className="sca-fg-toast sca-fg-success",i.innerHTML=`<div class="sca-fg-column">
                     <i>
                         <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">
                             <style>svg{fill:#28c76f}</style>
                             <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"/>
                         </svg>
                     </i>
                     <span>${t}</span>
                </div>

                <i id="close-fg-toast">
                      <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512">
                        <path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/>
                      </svg>
                </i>`,e.appendChild(i);let r=setTimeout(()=>v.removeToast(i),3e3);document.querySelector("#close-fg-toast")?.addEventListener("click",()=>v.removeToast(i,r))},removeToast:(e,t)=>{e.classList.add("hide"),t&&clearTimeout(t),setTimeout(()=>e.remove(),500)},HIDDEN_GIFT_POPUP:()=>{let e=FGSECOMAPP.fgAppearance?.gift_slider?.disable_slider_checkbox??{},t=document.querySelector(O.DISABLE_SLIDER_SECTION_ID)?.innerHTML??O.DISABLE_SLIDER_SECTION;return e?.enable?FGSECOMAPP.helper.templateHTML.render(t):""},handleCheckHiddenGiftSlider:e=>{let t=localStorage.getItem(e)-0,r=(FGSECOMAPP.fgAppearance?.gift_slider??{})?.disable_slider_checkbox??{},o=(r?.time??0)*60*1e3;return r?.enable&&!isNaN(t)&&t+o>Date.now()?!0:(localStorage.removeItem(e),!1)},init:()=>{v.fetchVariantsSelected(),v.renderProductPage(),v.renderElementGiftIconCollectionPage()}},F={...nt,syncStarRating:async e=>{await F.syncRatingProducts(e,A.APP_REVIEW_OPTION.gift_slider,()=>{console.log(`BOGOS track: judgeme-synced:${Date.now()}`)}),await F.syncRatingProducts(e,A.APP_REVIEW_OPTION.gift_slider,()=>{console.log(`BOGOS track: trustoo-synced:${Date.now()}`)},A.APP_REVIEW.trustoo)},renderAppReviewEl:(e,t=A.APP_REVIEW.judgeme)=>{let i=FGSECOMAPP.fgIntegration?.[t]??{},{display_star_rating:r,gift_slider:o,status:c}=i?.settings??{};if(!((c&&r&&o)??!1))return"";let g=`bogos_${t}_ratings`,n=u.convertStringToObj(localStorage.getItem(FGSECOMAPP.variables.constants?.[g])??""),{rating:d}=(n??[]).find(({product_id:a})=>a===e)??{};return t===A.APP_REVIEW.judgeme?F.renderStarRatingJudgeme(d,e):F.renderStarRatingTrustoo?.(d,e)}},M={shadowRoot:[],reCallCheckout:e=>{try{let t=FGSECOMAPP.fgSettings?.mode_override_checkout,i=e;i?.hasAttribute("sca_handle_checkout")||(i=document.querySelector("[sca_handle_checkout]:has(#sca-spinner-checkout)"),i=M.shadowRoot.reduce((o,c)=>{if(o)return o;let s=document.querySelector(c);return s?.shadowRoot?s.shadowRoot.querySelector("[sca_handle_checkout]:has(#sca-spinner-checkout)"):null},i));let r=JSON.parse(i.getAttribute("data-fg-checkout-btn"));if(i.value=r?.value??"",i.innerHTML=r?.innerHTML??"",i.disabled=!1,i.removeEventListener("click",M.progressEventCheckout),i.removeEventListener("touchstart",M.progressEventCheckout),i.removeAttribute("sca_handle_checkout"),t==="clone_checkout"){i.parentNode.querySelector("[sca_root_checkout]").click();return}t==="trigger_body"&&window.removeEventListener("click",M.handleEventCheckoutDocument,!0),FGSECOMAPP.variables.checkIsBlockCheckout=!1,i.click()}catch(t){window.location.replace(u.routePath("/checkout")),console.warn("BOGOS track: Error recall root event checkout",t)}},customLoading:async(e,t)=>{if(typeof FGSECOMAPP.helper?.scaCustomLoadingCheckout=="function"){await FGSECOMAPP.helper.scaCustomLoadingCheckout(e);return}if(e==="start"&&t)t.disabled=!0,t.setAttribute("data-fg-checkout-btn",JSON.stringify({innerHTML:t.innerHTML,value:t.value})),t.value=FGSECOMAPP.variables.Shopify?.sca_fg_value_checkout??"Loading...",t.innerHTML=FGSECOMAPP.variables.Shopify?.sca_fg_innerHTML??`<div id="sca-spinner-checkout" class="sca-spinner-border" role="status">
                        <span class="sca-loading">Loading...</span>
                    </div>`;else if(e==="end"&&t){let i=JSON.parse(t.getAttribute("data-fg-checkout-btn"));t.value=i?.value??"",t.innerHTML=i?.innerHTML??"",t.disabled=!1}else e==="error"?window.location.replace(u.routePath("/checkout")):console.warn("BOGOS track: Cannot define custom loading with type: ",e)},progressEventCheckout:async(e,t)=>{try{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();let{using_draft_order:i}=FGSECOMAPP.fgSettings??{},{checkIsBlockCheckout:r,conditions:o}=FGSECOMAPP.variables??{},c=t==="trigger_body"?e.target:e.currentTarget??e.target,{form:s}=c;if(await M.customLoading("start",c),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.START_VALIDATE_CHECKOUT,{detail:{}})),r)return!1;FGSECOMAPP.variables.checkIsBlockCheckout=!0,it.apply_discounts_shipping("checkout");try{if(s&&!FGSECOMAPP.variables.Shopify?.disable_fetch_cart_checkout){let a=new URL(s.action);a.searchParams.append("sca_checkout_form",""),new FormData(s).delete("checkout"),await u.fetch(a.toString(),{method:"POST",body:new FormData(s)})}}catch{console.log("BOGOS track: not type checkout btn")}let g=FGSECOMAPP.cartItems?.some(a=>u.checkCartItemIsGift(a));if(u.empty(FGSECOMAPP.offers)&&!g)return console.log("BOGOS track: not have orders and gifts"),M.reCallCheckout(c),!1;await u.fetchInfoCartUpdate();let n=[...FGSECOMAPP.cartItems],{arrGiftsRemove:d}=b.processCartWithOffers(n,FGSECOMAPP.offers,!1);if(await b.checkAllOffers(n,FGSECOMAPP.offers),d?.length>0)location.reload();else if(i&&!o.function&&g){let a=await H.draftOrder();FGSECOMAPP.variables.checkIsBlockCheckout=!1;let{invoice_url:f}=a?.sca_link_checkout??{};u.empty(f)?(console.warn("BOGOS track: error draft-order",a),M.reCallCheckout(c)):window.location.href=f}else console.log("BOGOS track: not using draft order"),FGSECOMAPP.variables.checkIsBlockCheckout=!1,M.reCallCheckout(c);await M.customLoading("end",c),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.END_VALIDATE_CHECKOUT,{detail:{status:"done",valid:!d?.length}}))}catch(i){await M.customLoading("error"),document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.END_VALIDATE_CHECKOUT,{detail:{status:"error"}})),console.error("BOGOS track: Error process checkout",i)}},handleEventCheckoutDocument:async e=>{e.target?.hasAttribute("sca_handle_checkout")&&await M.progressEventCheckout(e,"trigger_body")},renderEventCheckout:()=>{let e=FGSECOMAPP.fgSettings?.mode_override_checkout,{checkout_btn_query:t}=FGSECOMAPP.QUERY_SELECTOR,i=[...t?.tool,...t?.integration,...t?.default].filter(Boolean).join(","),r=[...document.querySelectorAll(i)];t?.tool?.filter(Boolean).join(", ").split(",").forEach(o=>{let[c,...s]=o.trim().split(" "),g=s.join(" ");if(!c.length||!g.length)return;let n=document.querySelector(c);n?.shadowRoot&&(M.shadowRoot.push(c),r.push(...n.shadowRoot.querySelectorAll(g)))}),r.forEach(o=>{let c=o.hasAttribute("sca_root_checkout"),s=o.hasAttribute("sca_clone_checkout"),g=o.hasAttribute("sca_handle_checkout"),n=!g;if(e==="clone_checkout"){if(c)return;if(!s&&!g){let d=o.cloneNode(!0);d.addEventListener("click",M.progressEventCheckout),d.addEventListener("touchstart",M.progressEventCheckout),d.addEventListener("touchend",M.progressEventCheckout),d.setAttribute("sca_handle_checkout",""),d.setAttribute("sca_clone_checkout",""),o.style.display="none",o.style.visibility="hidden",o.style.opacity="0",o.setAttribute("sca_root_checkout",""),o.parentNode?.appendChild(d)}n=s&&!g}n&&(o.addEventListener("click",M.progressEventCheckout),o.addEventListener("touchstart",M.progressEventCheckout),o.addEventListener("touchend",M.progressEventCheckout)),o.setAttribute("sca_handle_checkout",""),FGSECOMAPP.variables.hasDoneProcessCheckout=!0}),e==="trigger_body"&&(window.addEventListener("click",M.handleEventCheckoutDocument,!0),M.shadowRoot.forEach(o=>{document.querySelector(o).shadowRoot?.addEventListener("click",M.handleEventCheckoutDocument,!0)}))},fetchEvents:()=>{FGSECOMAPP.variables.scaCountRenderEventCheckout=0,FGSECOMAPP.variables.hasDoneProcessCheckout=!1;let e=setInterval(()=>{M.renderEventCheckout(),FGSECOMAPP.variables.scaCountRenderEventCheckout++,(FGSECOMAPP.variables.scaCountRenderEventCheckout>10||FGSECOMAPP.variables.hasDoneProcessCheckout)&&(FGSECOMAPP.variables.scaCountRenderEventCheckout=0,clearInterval(e))},400)},wallets:async e=>{try{let{paymentsConfig:t}=FGSECOMAPP.variables;if(u.empty(t)&&(t=await u.fetch("/payments/config?bogos").then(o=>o.json())||{paymentInstruments:{accessToken:null}},FGSECOMAPP.variables.paymentsConfig=t),u.empty(e))return u.empty(t);let{country:i,currency:r}=FGSECOMAPP.variables.Shopify;return await u.fetchCartDefault(),await u.fetch("/wallets/checkouts/?bogos",{method:"POST",headers:{accept:"*/*",authorization:`Basic ${window.btoa(t?.paymentInstruments?.accessToken)}`,"cache-control":"no-cache","content-type":"application/json",pragma:"no-cache"},body:JSON.stringify({checkout:{...e,country:i,presentment_currency:r?.active,line_items:FGSECOMAPP.SHOPIFY_CART.items}})}),!0}catch(t){return console.warn("BOGOS track: wallets/config",t),!1}},init:()=>{M.fetchEvents()}},it={...J,apply_discounts_shipping:(e="cart")=>{let t=(FGSECOMAPP.variables.bogos_shipping_discounts??[]).sort().toString();FGSECOMAPP.variables.bogos_shipping_discounts=FGSECOMAPP.offers.filter(r=>r.is_offer_shipping&&r.isReachConditions).map(r=>r.shopify_discount_settings?.code).filter(Boolean).sort(),(e==="checkout"||t!==FGSECOMAPP.variables.bogos_shipping_discounts.toString())&&J.apply_discounts(FGSECOMAPP.variables.bogos_shipping_discounts)}},H={...st,getInfoProducts:async(e,t)=>{await H.fetch({sca_products_handle:u.convertObjToString(e,"uri")},t).then(async i=>{let r=await i.json(),o=[],{currency:c}=FGSECOMAPP.variables.Shopify,g=(r.currency??"USD")!==c?.active;r?.products?.forEach(d=>{if(u.empty(d?.products?.id))return;let{products:a,collections:f}=d;o.push({...g?H.convertProductCurrency(a):a,collections:f})});let n=v.filterOfferToGiftThumbnail(o);v.renderGiftIconForProducts(n)}).catch(i=>{console.warn("BOGOS track: getInfoProductsByProxy",i)})},draftOrder:async()=>{try{let{shop:e,currency:t,add_cart_attributes:i,add_cart_discounts:r,country:o}=FGSECOMAPP.variables.Shopify,c=await H.fetch({sca_shop_name:e}).then(g=>g.json()),s=[];return i&&(s=Object.entries(c.cart[0]?.cart_attributes).map(([g,n])=>({key:g,value:`${n}`}))),c.cart=(c.cart??[]).map(g=>{g.product.collections=g.collections?.map(f=>({id:f.id})),g.product.tags=g.tags;let n=FGSECOMAPP.fgSettings.draft_order??{},d=n.discount_code||r&&typeof n.discount_code!="boolean"?g.product.discounts:[],a=Object.entries(g.product.properties??{}).map(([f,l])=>({key:f,value:`${l}`}));return{id:g.product.id,variant_id:g.product.variant_id,product_id:g.product.product_id,title:g.product.title,handle:g.product.handle,price:b.priceCartItem(g.product),quantity:g.product.quantity,product_type:g.product.product_type,vendor:g.product.vendor,tags:g.product.tags,collections:g.product.collections,selling_plan_allocation:g.product.selling_plan_allocation,discounts:d,properties:a}}),c.others={secomapp:{customer:SECOMAPP?.customer??{},fg_codes:SECOMAPP?.fg_codes??[],fgSettings:FGSECOMAPP.fgSettings},cookie_fg_code:FGSECOMAPP.variables.sca_fg_codes,shopify_currency:t,customer_location:FGSECOMAPP.customerLocation||o,cart_attributes:s,arr_offer_added:k.isSpecificOffer?void 0:FGSECOMAPP.arrOfferAdded,max_priority_draft_order:FGSECOMAPP.variables.maxTodayOfferPriority,offers_in_time:[...new Set(FGSECOMAPP.offers.map(g=>Number(g.offer_root)))],other_discount:[...FGSECOMAPP.variables.bogos_shipping_discounts??[],...FGSECOMAPP.variables.bogos_other_discounts??[]],market:SECOMAPP.market??{}},await H.fetch({data_checkout:u.convertObjToString(c,"uri")}).then(g=>g.json())||{sca_link_checkout:null}}catch(e){return{error:e.message}}}},{fetch:lt}=window,k={isSpecificOffer:!1,overrideFetch:()=>{let{disable_override_fetch:e}=FGSECOMAPP.variables.Shopify,{isCheckout:t,isHeadless:i}=FGSECOMAPP.variables??{};t||i||e||(window.fetch=async function(){let r=lt.apply(this,arguments);try{let o=typeof arguments[0]=="string"&&arguments[0],c=typeof arguments[1]?.body=="string"&&arguments[1]?.body,s=B.cart.test(o??""),g=o?.includes("graphql.json")&&B.graphql.test(c??"");if(s||g){let n=s?o.match(B.cart):c.match(B.graphql),d=()=>r.then(async function(a){a.ok&&await b.checkEventCart([`fetch-override:${n?.[0]}`])});FGSECOMAPP?.variables?.Shopify?.disable_async_process_fg?d().then():await d()}document.dispatchEvent(new CustomEvent(FGSECOMAPP.CUSTOM_EVENTS.FG_OVERRIDE_FETCH))}catch(o){console.warn("BOGOS track: fetch override error",o)}return r})},listenAPI:()=>{let e=u.debounce(function(){v.renderElementGiftIconCollectionPage()},1e3);new PerformanceObserver(t=>{let i=!1;t.getEntries().forEach(r=>{let{initiatorType:o,name:c,responseStatus:s}=r,g=["xmlhttprequest","fetch"].includes(o),n=["sca_attr_cart","_bogos-ignore","bogos_discount"].some(a=>c.includes(a));if(s>=400)return;let[d]=b.arrSaveAllFetch.slice(-1);if(g&&!n&&B.cart.test(c)){let a=c.match(B.cart)?.[0];!(d===`fetch-override:${a}`)&&b.checkEventCart([`observer:${a}`]).then()}window?.Spurit?.global?.loaded&&document.querySelector("#occ3-drawer .spurit-occ3__slide-drawer")&&(FGSECOMAPP.renderPromotionMessage(),FGSECOMAPP.fetchCheckoutEvents()),i||=g&&!c.includes(SECOMAPP.freegiftProxy)}),i&&e()}).observe({entryTypes:["resource"]})},shopify_getCart:()=>{try{if(FGSECOMAPP.variables.Shopify?.disableShopify_getCart||typeof Shopify?.getCart!="function")return;Shopify.getCart=async function(e){if(!FGSECOMAPP.variables.secomappGetCartRunning){FGSECOMAPP.variables.secomappGetCartRunning=!0,await b.checkEventCart(["Shopify.getCart",{}]);let t=await u.fetchCartDefault("sca_cart_xhr");typeof e=="function"&&(FGSECOMAPP.variables.fgCallback.push(e),e(t)),FGSECOMAPP.variables.secomappGetCartRunning=!1}FGSECOMAPP.fetchCheckoutEvents()},typeof ShopifyAPI<"u"&&typeof ShopifyAPI.getCart<"u"&&(ShopifyAPI.getCart=Shopify?.getCart),typeof Shopify?.api<"u"&&typeof Shopify?.api?.getCart<"u"&&(Shopify.api.getCart=Shopify?.getCart)}catch(e){console.warn("BOGOS track: initializeForXHR Shopify.getCart",e)}},createGlobalVariables:()=>{let{cart_and_checkout_validation:e,offer_process:t}=FGSECOMAPP.fgSettings??{};k.isSpecificOffer=e?.offer||t===A.OFFER_TYPE.function,window.fgData?.offers?.forEach(i=>{FGSECOMAPP.variables.giftIds=FGSECOMAPP.variables.giftIds.concat(i.gift_items.map(o=>o.variant_shopify_id)),FGSECOMAPP.variables.gifts.originalProducts=FGSECOMAPP.variables.gifts.originalProducts.concat(i.gift_products.map(o=>o.original_product_shopify_id)),t!==A.OFFER_TYPE.function&&(FGSECOMAPP.variables.gifts.clonedProducts=FGSECOMAPP.variables.gifts.clonedProducts.concat(i.gift_products.map(o=>o.product_shopify_id))),FGSECOMAPP.variables.conditions.locations||=!u.empty(i.sub_conditions?.customer_locations),FGSECOMAPP.variables.conditions.collections||=i.offer_conditions?.[0]?.product_narrow?.some(o=>o.type===A.NARROW_TYPE.collection)??!1;let r=i.gift_settings.discount_method===A.DISCOUNT_TYPE.shipping;FGSECOMAPP.variables.conditions.shipping||=r,r&&FGSECOMAPP.variables.gifts.offers_shipping.push(i.id.toString())}),FGSECOMAPP.variables.giftIds=[...new Set(FGSECOMAPP.variables.giftIds)].filter(Boolean),FGSECOMAPP.variables.gifts.originalProducts=[...new Set(FGSECOMAPP.variables.gifts.originalProducts)].filter(Boolean),FGSECOMAPP.variables.gifts.clonedProducts=[...new Set(FGSECOMAPP.variables.gifts.clonedProducts)].filter(Boolean),window.BOGOS_CORE?.helper&&(BOGOS_CORE.helper.gift={renderCustomizeForProduct:v.renderCustomizeForProduct,prepareCheckout:async()=>await b.checkEventCart(["bogos:checkout"]),checkItemIsGift:u.checkCartItemIsGift}),FGSECOMAPP.helper={...FGSECOMAPP.helper,initializeForXHR:k.shopify_getCart,customLoadingCheckout:M.customLoading,fetchCheckoutEvents:M.fetchEvents,renderPromotionMessage:v.renderPromotionMessage,renderProductPage:v.renderProductPage,addGiftToCart:b.handleAddGift},FGSECOMAPP.fetchCheckoutEvents=M.fetchEvents,FGSECOMAPP.renderPromotionMessage=v.renderPromotionMessage,FGSECOMAPP.variables.isCheckout=document.querySelector("#secomapp_freegifts_version")?.getAttribute("data-template")==="fg-checkout",FGSECOMAPP.variables.conditions.function=t===A.OFFER_TYPE.function,document.addEventListener(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_FG_PROCESS,i=>{u.debounce(async()=>{if(k.processing)return;k.processing=!0;let r=W.convertStorefrontCart({data:{cart:i.detail?.cart}},!0);await b.checkEventCart([i.detail?.event??"bogos:gifts"],r?.shopify_cart?.items).then(),k.processing=!1},250)()}),document.addEventListener(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_FG_INIT,()=>{b.init("bogos:rollback",null,!0).then()}),document.addEventListener(FGSECOMAPP.CUSTOM_EVENTS.BOGOS_FG_CART_MESSAGE,()=>v.renderPromotionMessage()),document.addEventListener(FGSECOMAPP.CUSTOM_EVENTS.RERENDER_GIFT_SLIDER,()=>{let{general:i}=FGSECOMAPP.fgAppearance?.gift_slider,o=i?.use_old_version===!1?".bogos-offer-gift-items-container":".bogos-gift-items";document.querySelectorAll(o).forEach(c=>{let s=parseInt(c.getAttribute("data-show-desktop"));v.renderGlider(c,isNaN(s)?4:s)})})},init:async()=>{k.createGlobalVariables(),M.init(),await b.init("init-page",()=>{k.listenAPI(),k.overrideFetch(),k.shopify_getCart()}),v.init(),setTimeout(()=>{v.renderPromotionMessage()},2e3)}};k.init().then()})();})();
